{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"@timestamp\":{\"count\":1},\"agent.type\":{\"count\":8},\"event.action\":{\"count\":1},\"event.category\":{\"count\":8},\"event.dataset\":{\"count\":6},\"event.kind\":{\"count\":2},\"event.module\":{\"count\":6},\"event.outcome\":{\"count\":3},\"event.type\":{\"count\":1},\"file.path\":{\"count\":4},\"host.name\":{\"count\":1},\"message\":{\"count\":4},\"package.name\":{\"count\":1},\"package.version\":{\"count\":1},\"process.args\":{\"count\":1},\"process.command_line\":{\"count\":4},\"process.entity_id\":{\"count\":1},\"process.exit_code\":{\"count\":4},\"process.name\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":"logs-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":"logs-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T16:46:38.680Z","created_by":"u_elastic_found","id":"logs-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-08-07T04:07:01.675Z","updated_by":"u_elastic_found","version":"WzcxMjgsN10="}
{"attributes":{"color":"#657836","description":"","name":"pl-5"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T19:38:54.205Z","created_by":"u_elastic_found","id":"ba739d14-f0dc-4493-94f5-7e9ade4cb931","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-08-07T19:38:54.205Z","updated_by":"u_elastic_found","version":"WzUyNDY2LDdd"}
{"attributes":{"color":"#d4cfb9","description":"","name":"metrics"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI1LDdd"}
{"attributes":{"color":"#cde303","description":"","name":"rmf"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI2LDdd"}
{"attributes":{"color":"#c7f175","description":"","name":"compliance"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI3LDdd"}
{"attributes":{"description":"**Why this visualization works:**\nThis table is the most critical tool for detailed inventory validation. It provides a comprehensive list of every system reporting to Elastic, along with key identifying information and the timestamp of the last log received.\n\n**How an analyst can use it:**\nUse this table as your primary reference for validating your official inventory. Export the data and perform a diff against your CMDB. \n- **Sort by 'Last Seen'** to identify systems that have recently stopped reporting, which could indicate a system has been decommissioned or is having agent issues.\n- **Filter by `host.name`** or other attributes to investigate specific assets.\n- Any system in this list but not in your CMDB is an **'undocumented asset'** and must be investigated.\n- Any system in your CMDB but not on this list is an **'unmonitored asset'**.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"host.name: *\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-004328] Discovered Systems Details","uiStateJSON":"{}","version":1,"visState":"{\"aggs\":[{\"enabled\":true,\"id\":\"1\",\"params\":{\"customLabel\":\"System Name\",\"excludeIsRegex\":true,\"field\":\"host.name\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"_key\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":100},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"2\",\"params\":{\"aggregate\":\"concat\",\"customLabel\":\"Operating System\",\"field\":\"host.os.full\",\"size\":1,\"sortField\":\"@timestamp\",\"sortOrder\":\"desc\"},\"schema\":\"metric\",\"type\":\"top_hits\"},{\"enabled\":true,\"id\":\"3\",\"params\":{\"aggregate\":\"concat\",\"customLabel\":\"IP Address\",\"field\":\"host.ip\",\"size\":1,\"sortField\":\"@timestamp\",\"sortOrder\":\"desc\"},\"schema\":\"metric\",\"type\":\"top_hits\"},{\"enabled\":true,\"id\":\"4\",\"params\":{\"aggregate\":\"concat\",\"customLabel\":\"Cloud Provider\",\"field\":\"cloud.provider\",\"size\":1,\"sortField\":\"@timestamp\",\"sortOrder\":\"desc\"},\"schema\":\"metric\",\"type\":\"top_hits\"},{\"enabled\":true,\"id\":\"5\",\"params\":{\"customLabel\":\"Last Seen\",\"field\":\"@timestamp\"},\"schema\":\"metric\",\"type\":\"max\"}],\"params\":{\"autoFitRowToContent\":false,\"perPage\":25,\"percentageCol\":\"\",\"showMetricsAtAllLevels\":false,\"showPartialRows\":false,\"showToolbar\":true,\"showTotal\":false,\"sort\":{\"columnIndex\":4,\"direction\":\"desc\"},\"totalFunc\":\"sum\"},\"title\":\"[CCI-004328] Discovered Systems Details\",\"type\":\"table\"}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T19:37:26.074Z","created_by":"u_elastic_found","id":"cci-004328-systems-table","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"ba739d14-f0dc-4493-94f5-7e9ade4cb931","name":"tag-ref-ba739d14-f0dc-4493-94f5-7e9ade4cb931","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-07T19:41:09.627Z","updated_by":"u_elastic_found","version":"Wzc0MzcsN10="}
{"attributes":{"description":"**Why this visualization works:**\nIt gives an immediate, high-level count of all unique systems currently sending data to Elastic. This number serves as a quick baseline for inventory validation.\n\n**How an analyst can use it:**\nCompare this number directly with the total number of assets listed in your official inventory or CMDB. A significant discrepancy is an immediate indicator that your inventory is out of date. If this number is higher than your CMDB, you have undocumented systems. If it's lower, you have unmonitored systems.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"host.name: *\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-004328] Total Discovered Systems","uiStateJSON":"{}","version":1,"visState":"{\"aggs\":[{\"enabled\":true,\"id\":\"1\",\"params\":{\"customLabel\":\"Total Discovered Systems\",\"emptyAsNull\":false,\"field\":\"host.name\"},\"schema\":\"metric\",\"type\":\"cardinality\"}],\"params\":{\"addLegend\":false,\"addTooltip\":true,\"metric\":{\"colorSchema\":\"Green to Red\",\"colorsRange\":[{\"from\":0,\"to\":10000}],\"invertColors\":false,\"labels\":{\"show\":true},\"metricColorMode\":\"None\",\"percentageMode\":false,\"style\":{\"bgColor\":false,\"fontSize\":60,\"labelColor\":false,\"subText\":\"\"},\"useRanges\":false},\"type\":\"metric\"},\"title\":\"[CCI-004328] Total Discovered Systems\",\"type\":\"metric\"}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T19:37:26.074Z","created_by":"u_elastic_found","id":"cci-004328-total-systems","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"ba739d14-f0dc-4493-94f5-7e9ade4cb931","name":"tag-ref-ba739d14-f0dc-4493-94f5-7e9ade4cb931","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-07T19:40:46.340Z","updated_by":"u_elastic_found","version":"Wzc0MzUsN10="}
{"attributes":{"description":"This section provides visualizations to help you develop and validate an inventory of organizational systems, a key requirement of CCI-004328. These visualizations leverage log data to discover systems reporting to Elastic, which can then be compared against your authoritative inventory (like a CMDB).\n\n**How an analyst can use it:**\n\n1.  **Component-Level Assessment:** To assess a specific part of your architecture, use the global filters at the top of the dashboard. For example, filter by `cloud.provider: 'aws'` to see only AWS systems, or `host.geo.name: 'us-east-1'` to focus on a specific region.\n2.  **Inventory Validation:** The core task is to compare the systems discovered here with your official inventory. Use the 'Discovered Systems Details' table for this. Any system appearing in this dashboard that is *not* in your CMDB is an **undocumented asset** and requires investigation. Conversely, any system in your CMDB that is *not* in this dashboard is an **unmonitored asset** and needs to have logging configured.\n3.  **Monitor Trends:** Observe the 'Total Discovered Systems' and 'System Activity by Operating System' visualizations over time. A sudden, unexpected increase in systems could indicate unauthorized devices on the network. A new, unauthorized OS appearing could also be a sign of a policy violation or threat.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-004328] Develop System Inventory","uiStateJSON":"{}","version":1,"visState":"{\"aggs\":[],\"params\":{\"fontSize\":12,\"markdown\":\"# [CCI-004328] Develop System Inventory\\n\\n### Discover and validate systems on the network.\",\"openLinksInNewTab\":false},\"title\":\"[CCI-004328] Develop System Inventory\",\"type\":\"markdown\"}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T19:37:26.074Z","created_by":"u_elastic_found","id":"cci-004328-title","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"ba739d14-f0dc-4493-94f5-7e9ade4cb931","name":"tag-ref-ba739d14-f0dc-4493-94f5-7e9ade4cb931","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-07T19:40:37.121Z","updated_by":"u_elastic_found","version":"Wzc0MzQsN10="}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T19:10:00.315Z","created_by":"u_elastic_found","id":".ml-anomalies-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-23T01:28:26.924Z","updated_by":"u_elastic_found","version":"WzE2MDMsMl0="}
{"attributes":{"color":"#38ab91","description":"","name":"pm-5"},"coreMigrationVersion":"8.8.0","created_at":"2025-09-07T23:50:24.232Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-09-07T23:50:24.232Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzcxMjIyLDdd"}
{"attributes":{"color":"#0e431f","description":"","name":"ml"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:32:52.214Z","created_by":"u_elastic_found","id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T18:32:52.214Z","updated_by":"u_elastic_found","version":"WzMyNzcsMV0="}
{"attributes":{"description":"This table details the specific anomalies where a rare or new operating system was detected.\n\n**Why this visualization works:**\nIt provides the direct evidence needed for investigation, showing the exact OS ('by_field_value') and the host it was found on.\n\n**How an analyst can use it:**\nWhen the trend chart shows an anomaly, consult this table. Identify the rare OS and the associated host. Your task is to verify if this OS is authorized for this system. If not, it represents a policy violation and a deviation from your asset inventory baseline (CCI-004328).","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:pm-5-cci-004328-rare-os-detection-job\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[PM-5, CCI-004328] ML - Detailed Rare OS Anomalies","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[PM-5, CCI-004328] ML - Detailed Rare OS Anomalies\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\",\"customLabel\":\"Max Anomaly Score\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"by_field_value\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true,\"customLabel\":\"Rare Operating System\"},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"cloud.provider\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":6,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-09-10T00:13:09.600Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"pm-5-cci-004328-ml-rare-os-table","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","name":"tag-ref-681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-10T00:15:28.072Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk2MjIsN10="}
{"attributes":{"description":"This chart shows the anomaly score over time from the ML job that identifies rare or new operating systems on the network.\n\n**Why this visualization works:**\nIt automatically flags systems that don't conform to your organization's baseline OS standards, which is a key part of inventory management (CCI-004328). A rare OS could be an unauthorized device, a misconfigured system, or even a sign of a compromised host.\n\n**How an analyst can use it:**\nMonitor for any spikes in the anomaly score. A score greater than zero indicates a rare OS was detected. Investigate these spikes using the detailed anomaly table to identify the specific host and the rare OS.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:pm-5-cci-004328-rare-os-detection-job\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[PM-5, CCI-004328] ML - Rare OS Anomaly Score Trend","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[PM-5, CCI-004328] ML - Rare OS Anomaly Score Trend\",\"type\":\"area\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"date_histogram\",\"params\":{\"field\":\"@timestamp\",\"timeRange\":{\"from\":\"now-15m\",\"to\":\"now\"},\"useNormalizedEsInterval\":true,\"extendToTimeRange\":false,\"scaleMetricValues\":false,\"interval\":\"auto\",\"used_interval\":\"30s\",\"drop_partials\":false,\"min_doc_count\":1,\"extended_bounds\":{}},\"schema\":\"segment\"}],\"params\":{\"addTooltip\":true,\"addLegend\":true,\"legendPosition\":\"right\",\"scale\":\"linear\",\"mode\":\"normal\",\"times\":[],\"addTimeMarker\":false,\"defaultYExtents\":false,\"setYExtents\":false,\"yAxis\":{},\"legendSize\":\"auto\",\"type\":\"area\",\"grid\":{\"categoryLines\":false},\"categoryAxes\":[{\"id\":\"CategoryAxis-1\",\"type\":\"category\",\"position\":\"bottom\",\"show\":true,\"scale\":{\"type\":\"linear\"},\"labels\":{\"show\":true,\"filter\":true,\"truncate\":100},\"title\":{},\"style\":{}}],\"valueAxes\":[{\"id\":\"ValueAxis-1\",\"name\":\"LeftAxis-1\",\"type\":\"value\",\"position\":\"left\",\"show\":true,\"scale\":{\"type\":\"linear\",\"mode\":\"normal\"},\"labels\":{\"show\":true,\"rotate\":0,\"filter\":true,\"truncate\":100},\"title\":{\"text\":\"\"},\"style\":{}}],\"seriesParams\":[{\"show\":true,\"type\":\"area\",\"mode\":\"stacked\",\"data\":{\"label\":\"Max anomaly_score\",\"id\":\"1\"},\"drawLinesBetweenPoints\":true,\"lineWidth\":2,\"showCircles\":true,\"circlesRadius\":1,\"interpolate\":\"linear\",\"valueAxis\":\"ValueAxis-1\"}],\"detailedTooltip\":true,\"palette\":{\"type\":\"palette\",\"name\":\"default\"},\"fittingFunction\":\"linear\",\"truncateLegend\":true,\"maxLegendLines\":1,\"radiusRatio\":9,\"thresholdLine\":{\"show\":false,\"value\":10,\"width\":1,\"style\":\"full\",\"color\":\"#FCD883\"},\"labels\":{}}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-09-10T00:13:09.600Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"pm-5-cci-004328-ml-rare-os-trend","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","name":"tag-ref-681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-10T00:14:39.847Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk2MTgsN10="}
{"attributes":{"description":"This visualization displays the anomaly score over time for the ML job that detects an unusual increase in the number of unique hosts.\n\n**Why this visualization works:**\nIt provides a continuous, automated check on your asset inventory baseline. A sudden spike in new hosts, flagged as an anomaly, could indicate unauthorized devices connecting to the network or a misconfiguration in asset provisioning. This is a leading indicator for maintaining inventory accuracy (CCI-004328).\n\n**How an analyst can use it:**\nLook for spikes in the anomaly score. A high score suggests a significant deviation from the norm. Use the time selector to isolate these periods and investigate the corresponding detailed anomaly table to identify the specific hosts and their characteristics that contributed to the anomaly.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:pm-5-cci-004328-004329-new-hosts-trend-job\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[PM-5, CCI-004328, CCI-004329] ML - New Hosts Anomaly Score Trend","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[PM-5, CCI-004328, CCI-004329] ML - New Hosts Anomaly Score Trend\",\"type\":\"area\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"date_histogram\",\"params\":{\"field\":\"@timestamp\",\"timeRange\":{\"from\":\"now-15m\",\"to\":\"now\"},\"useNormalizedEsInterval\":true,\"extendToTimeRange\":false,\"scaleMetricValues\":false,\"interval\":\"auto\",\"used_interval\":\"30s\",\"drop_partials\":false,\"min_doc_count\":1,\"extended_bounds\":{}},\"schema\":\"segment\"}],\"params\":{\"addTooltip\":true,\"addLegend\":true,\"legendPosition\":\"right\",\"scale\":\"linear\",\"mode\":\"normal\",\"times\":[],\"addTimeMarker\":false,\"defaultYExtents\":false,\"setYExtents\":false,\"yAxis\":{},\"legendSize\":\"auto\",\"type\":\"area\",\"grid\":{\"categoryLines\":false},\"categoryAxes\":[{\"id\":\"CategoryAxis-1\",\"type\":\"category\",\"position\":\"bottom\",\"show\":true,\"scale\":{\"type\":\"linear\"},\"labels\":{\"show\":true,\"filter\":true,\"truncate\":100},\"title\":{},\"style\":{}}],\"valueAxes\":[{\"id\":\"ValueAxis-1\",\"name\":\"LeftAxis-1\",\"type\":\"value\",\"position\":\"left\",\"show\":true,\"scale\":{\"type\":\"linear\",\"mode\":\"normal\"},\"labels\":{\"show\":true,\"rotate\":0,\"filter\":true,\"truncate\":100},\"title\":{\"text\":\"\"},\"style\":{}}],\"seriesParams\":[{\"show\":true,\"type\":\"area\",\"mode\":\"stacked\",\"data\":{\"label\":\"Max anomaly_score\",\"id\":\"1\"},\"drawLinesBetweenPoints\":true,\"lineWidth\":2,\"showCircles\":true,\"circlesRadius\":1,\"interpolate\":\"linear\",\"valueAxis\":\"ValueAxis-1\"}],\"detailedTooltip\":true,\"palette\":{\"type\":\"palette\",\"name\":\"default\"},\"fittingFunction\":\"linear\",\"truncateLegend\":true,\"maxLegendLines\":1,\"radiusRatio\":9,\"thresholdLine\":{\"show\":false,\"value\":10,\"width\":1,\"style\":\"full\",\"color\":\"#FCD883\"},\"labels\":{}}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-09-10T00:13:09.600Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"pm-5-cci-004328-004329-ml-new-hosts-trend","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","name":"tag-ref-681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-10T00:14:05.410Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk2MTUsN10="}
{"attributes":{"description":"This table lists the specific anomalies detected when an unusual number of new hosts appeared on the network.\n\n**Why this visualization works:**\nIt provides the granular details needed for an investigation, directly linking the anomaly to influencer fields like the OS family, cloud provider, or geographic location. This helps you quickly understand the context of the new hosts.\n\n**How an analyst can use it:**\nWhen the trend chart shows a spike, use this table to see the details. Sort by 'anomaly_score' to prioritize the most significant events. Examine the influencer columns to identify patterns—for example, are all new hosts from a specific cloud provider or running an unexpected OS? This information is critical for validating your asset inventory (CCI-004329).","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:pm-5-cci-004328-004329-new-hosts-trend-job\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[PM-5, CCI-004328, CCI-004329] ML - Detailed New Host Anomalies","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[PM-5, CCI-004328, CCI-004329] ML - Detailed New Host Anomalies\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\",\"customLabel\":\"Max Anomaly Score\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.os.family\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"5\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"cloud.provider\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"6\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.geo.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-09-10T00:13:09.600Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"pm-5-cci-004328-004329-ml-new-hosts-table","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","name":"tag-ref-681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-10T00:14:24.753Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk2MTcsN10="}
{"attributes":{"description":"This chart displays the anomaly score over time for the ML job that detects when a host unexpectedly stops sending data.\n\n**Why this visualization works:**\nIt helps validate your inventory by identifying assets that have gone silent (CCI-004329). A host that stops reporting could be offline due to a failure, or its monitoring agent could have been disabled, either accidentally or maliciously.\n\n**How an analyst can use it:**\nLook for spikes in the anomaly score. Each spike represents a host (or group of hosts) that the ML model expected to see but didn't. Use the detailed table to find out which specific host stopped reporting.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:pm-5-cci-004328-004329-hosts-stopped-reporting-job\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[PM-5, CCI-004328, CCI-004329] ML - Hosts Stopped Reporting Anomaly Trend","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[PM-5, CCI-004328, CCI-004329] ML - Hosts Stopped Reporting Anomaly Trend\",\"type\":\"area\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"date_histogram\",\"params\":{\"field\":\"@timestamp\",\"timeRange\":{\"from\":\"now-15m\",\"to\":\"now\"},\"useNormalizedEsInterval\":true,\"extendToTimeRange\":false,\"scaleMetricValues\":false,\"interval\":\"auto\",\"used_interval\":\"30s\",\"drop_partials\":false,\"min_doc_count\":1,\"extended_bounds\":{}},\"schema\":\"segment\"}],\"params\":{\"addTooltip\":true,\"addLegend\":true,\"legendPosition\":\"right\",\"scale\":\"linear\",\"mode\":\"normal\",\"times\":[],\"addTimeMarker\":false,\"defaultYExtents\":false,\"setYExtents\":false,\"yAxis\":{},\"legendSize\":\"auto\",\"type\":\"area\",\"grid\":{\"categoryLines\":false},\"categoryAxes\":[{\"id\":\"CategoryAxis-1\",\"type\":\"category\",\"position\":\"bottom\",\"show\":true,\"scale\":{\"type\":\"linear\"},\"labels\":{\"show\":true,\"filter\":true,\"truncate\":100},\"title\":{},\"style\":{}}],\"valueAxes\":[{\"id\":\"ValueAxis-1\",\"name\":\"LeftAxis-1\",\"type\":\"value\",\"position\":\"left\",\"show\":true,\"scale\":{\"type\":\"linear\",\"mode\":\"normal\"},\"labels\":{\"show\":true,\"rotate\":0,\"filter\":true,\"truncate\":100},\"title\":{\"text\":\"\"},\"style\":{}}],\"seriesParams\":[{\"show\":true,\"type\":\"area\",\"mode\":\"stacked\",\"data\":{\"label\":\"Max anomaly_score\",\"id\":\"1\"},\"drawLinesBetweenPoints\":true,\"lineWidth\":2,\"showCircles\":true,\"circlesRadius\":1,\"interpolate\":\"linear\",\"valueAxis\":\"ValueAxis-1\"}],\"detailedTooltip\":true,\"palette\":{\"type\":\"palette\",\"name\":\"default\"},\"fittingFunction\":\"linear\",\"truncateLegend\":true,\"maxLegendLines\":1,\"radiusRatio\":9,\"thresholdLine\":{\"show\":false,\"value\":10,\"width\":1,\"style\":\"full\",\"color\":\"#FCD883\"},\"labels\":{}}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-09-10T00:13:09.600Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"pm-5-cci-004328-004329-ml-hosts-stopped-reporting-trend","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","name":"tag-ref-681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-10T00:15:43.104Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk2MjMsN10="}
{"attributes":{"color":"#f21b44","description":"","name":"mltitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:40:46.065Z","created_by":"u_elastic_found","id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:40:46.065Z","updated_by":"u_elastic_found","version":"WzQ2OTcsMl0="}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":2}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"result_timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-19T20:46:04.393Z","created_by":"u_3997454937_cloud","id":"ml-anomalies-index-pattern","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:12:44.803Z","updated_by":"u_elastic_found","version":"WzEwNDcsMl0="}
{"attributes":{"description":"This visualization displays the health status of system inventory development for CCI-004328 based on anomaly scores from associated ML jobs. These jobs detect undocumented assets, rare operating systems, and unmonitored assets. A green status indicates normal inventory activity, yellow indicates a minor anomaly, and red signifies a critical issue, such as a spike in new, unknown hosts, that requires immediate investigation.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:pm-5-cci-004328-004329-new-hosts-trend-job OR job_id:pm-5-cci-004328-rare-os-detection-job OR job_id:pm-5-cci-004328-004329-hosts-stopped-reporting-job\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-004328] Develop System Inventory ML","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-004328] Develop System Inventory ML\",\"type\":\"metrics\",\"aggs\":[],\"params\":{\"time_range_mode\":\"entire_time_range\",\"axis_formatter\":\"number\",\"axis_position\":\"left\",\"axis_scale\":\"normal\",\"background_color_rules\":[{\"value\":100,\"id\":\"a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6\",\"background_color\":\"rgba(249,3,3,1)\",\"color\":\"rgba(0,0,0,1)\",\"operator\":\"gte\"},{\"value\":20,\"id\":\"b2c3d4e5-f6g7-h8i9-j0k1-l2m3n4o5p6q7\",\"background_color\":\"rgba(255,221,0,1)\",\"color\":\"rgba(0,0,0,1)\",\"operator\":\"gte\"},{\"value\":0,\"id\":\"c3d4e5f6-g7h8-i9j0-k1l2-m3n4o5p6q7r8\",\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"operator\":\"gte\"}],\"bar_color_rules\":[],\"drop_last_bucket\":0,\"filter\":{\"language\":\"kuery\",\"query\":\"job_id:pm-5-cci-004328-004329-new-hosts-trend-job OR job_id:pm-5-cci-004328-rare-os-detection-job OR job_id:pm-5-cci-004328-004329-hosts-stopped-reporting-job\"},\"id\":\"cci-004328-title-ml\",\"series\":[{\"time_range_mode\":\"entire_time_range\",\"axis_position\":\"right\",\"chart_type\":\"line\",\"color\":\"#68BC00\",\"fill\":0.5,\"formatter\":\"0,0.[00]\",\"hidden\":false,\"id\":\"metric-1\",\"label\":\"[CCI-004328] Develop System Inventory\",\"line_width\":1,\"metrics\":[{\"field\":\"anomaly_score\",\"id\":\"max-anomaly-score\",\"type\":\"max\"}],\"override_index_pattern\":0,\"split_mode\":\"everything\",\"stacked\":\"none\"}],\"show_legend\":false,\"time_field\":\"@timestamp\",\"type\":\"metric\",\"use_kibana_indexes\":true,\"interval\":\"\",\"truncate_legend\":1,\"max_lines_legend\":1,\"show_grid\":1,\"tooltip_mode\":\"show_all\",\"isModelInvalid\":false,\"index_pattern_ref_name\":\"metrics_0_index_pattern\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-09-10T00:19:45.317Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"cci-004328-title-ml","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","name":"tag-ref-681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","name":"tag-ref-7dbb121c-e6c4-4063-88e0-37634f9b6a92","type":"tag"},{"id":"ml-anomalies-index-pattern","name":"metrics_0_index_pattern","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-10T00:23:58.666Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk2NDEsN10="}
{"attributes":{"description":"This table lists the specific anomalies for hosts that have stopped reporting to the network.\n\n**Why this visualization works:**\nIt pinpoints the exact asset ('over_field_value') that has gone missing from your monitoring coverage. This is essential for maintaining an accurate and validated inventory (CCI-004329).\n\n**How an analyst can use it:**\nAfter seeing a spike on the trend chart, come to this table. The 'over_field_value' column will show the name of the host that stopped reporting. Your task is to investigate why this host is silent. Is it decommissioned, experiencing an outage, or has its security agent been tampered with?","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:pm-5-cci-004328-004329-hosts-stopped-reporting-job\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[PM-5, CCI-004328, CCI-004329] ML - Detailed Hosts Stopped Reporting Anomalies","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[PM-5, CCI-004328, CCI-004329] ML - Detailed Hosts Stopped Reporting Anomalies\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\",\"customLabel\":\"Max Anomaly Score\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"over_field_value\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true,\"customLabel\":\"Host That Stopped Reporting\"},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.os.full\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"cloud.provider\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-09-10T00:13:09.600Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"pm-5-cci-004328-004329-ml-hosts-stopped-reporting-table","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","name":"tag-ref-681bdf8c-7f06-4d61-b7a0-9d188cab5c8f","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-10T00:16:14.724Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk2MjUsN10="}
{"attributes":{"color":"#f8bfc4","description":"","name":"dashboard"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-25T21:49:36.527Z","created_by":"u_elastic_found","id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-25T21:49:36.527Z","updated_by":"u_elastic_found","version":"WzI2MzUxLDNd"}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"visualization\",\"title\":\"[CCI-004328] Discovered Systems Details\",\"panelRefName\":\"panel_97d98858-7df4-4109-8445-e7292406104c\",\"embeddableConfig\":{\"description\":\"**Why this visualization works:**\\nThis table is the most critical tool for detailed inventory validation. It provides a comprehensive list of every system reporting to Elastic, along with key identifying information and the timestamp of the last log received.\\n\\n**How an analyst can use it:**\\nUse this table as your primary reference for validating your official inventory. Export the data and perform a diff against your CMDB. \\n- **Sort by 'Last Seen'** to identify systems that have recently stopped reporting, which could indicate a system has been decommissioned or is having agent issues.\\n- **Filter by `host.name`** or other attributes to investigate specific assets.\\n- Any system in this list but not in your CMDB is an **'undocumented asset'** and must be investigated.\\n- Any system in your CMDB but not on this list is an **'unmonitored asset'**.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"97d98858-7df4-4109-8445-e7292406104c\",\"gridData\":{\"i\":\"97d98858-7df4-4109-8445-e7292406104c\",\"y\":14,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-004328] Total Discovered Systems\",\"panelRefName\":\"panel_27b41d88-af81-445b-8891-b4fd6b617c33\",\"embeddableConfig\":{\"description\":\"**Why this visualization works:**\\nIt gives an immediate, high-level count of all unique systems currently sending data to Elastic. This number serves as a quick baseline for inventory validation.\\n\\n**How an analyst can use it:**\\nCompare this number directly with the total number of assets listed in your official inventory or CMDB. A significant discrepancy is an immediate indicator that your inventory is out of date. If this number is higher than your CMDB, you have undocumented systems. If it's lower, you have unmonitored systems.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"27b41d88-af81-445b-8891-b4fd6b617c33\",\"gridData\":{\"i\":\"27b41d88-af81-445b-8891-b4fd6b617c33\",\"y\":14,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-004328] Develop System Inventory\",\"panelRefName\":\"panel_239bb095-a16e-4eff-ab35-83ff44690e5a\",\"embeddableConfig\":{\"description\":\"This section provides visualizations to help you develop and validate an inventory of organizational systems, a key requirement of CCI-004328. These visualizations leverage log data to discover systems reporting to Elastic, which can then be compared against your authoritative inventory (like a CMDB).\\n\\n**How an analyst can use it:**\\n\\n1.  **Component-Level Assessment:** To assess a specific part of your architecture, use the global filters at the top of the dashboard. For example, filter by `cloud.provider: 'aws'` to see only AWS systems, or `host.geo.name: 'us-east-1'` to focus on a specific region.\\n2.  **Inventory Validation:** The core task is to compare the systems discovered here with your official inventory. Use the 'Discovered Systems Details' table for this. Any system appearing in this dashboard that is *not* in your CMDB is an **undocumented asset** and requires investigation. Conversely, any system in your CMDB that is *not* in this dashboard is an **unmonitored asset** and needs to have logging configured.\\n3.  **Monitor Trends:** Observe the 'Total Discovered Systems' and 'System Activity by Operating System' visualizations over time. A sudden, unexpected increase in systems could indicate unauthorized devices on the network. A new, unauthorized OS appearing could also be a sign of a policy violation or threat.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"239bb095-a16e-4eff-ab35-83ff44690e5a\",\"gridData\":{\"i\":\"239bb095-a16e-4eff-ab35-83ff44690e5a\",\"y\":0,\"x\":0,\"w\":48,\"h\":7}},{\"type\":\"visualization\",\"title\":\"[PM-5, CCI-004328] ML - Detailed Rare OS Anomalies\",\"panelRefName\":\"panel_88f8a931-a7c1-4527-9491-b0f4ae2f6ec7\",\"embeddableConfig\":{\"description\":\"This table details the specific anomalies where a rare or new operating system was detected.\\n\\n**Why this visualization works:**\\nIt provides the direct evidence needed for investigation, showing the exact OS ('by_field_value') and the host it was found on.\\n\\n**How an analyst can use it:**\\nWhen the trend chart shows an anomaly, consult this table. Identify the rare OS and the associated host. Your task is to verify if this OS is authorized for this system. If not, it represents a policy violation and a deviation from your asset inventory baseline (CCI-004328).\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"88f8a931-a7c1-4527-9491-b0f4ae2f6ec7\",\"gridData\":{\"i\":\"88f8a931-a7c1-4527-9491-b0f4ae2f6ec7\",\"y\":29,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[PM-5, CCI-004328] ML - Rare OS Anomaly Score Trend\",\"panelRefName\":\"panel_1030eaa7-9a19-4eb3-9c97-cc1c59e186f7\",\"embeddableConfig\":{\"description\":\"This chart shows the anomaly score over time from the ML job that identifies rare or new operating systems on the network.\\n\\n**Why this visualization works:**\\nIt automatically flags systems that don't conform to your organization's baseline OS standards, which is a key part of inventory management (CCI-004328). A rare OS could be an unauthorized device, a misconfigured system, or even a sign of a compromised host.\\n\\n**How an analyst can use it:**\\nMonitor for any spikes in the anomaly score. A score greater than zero indicates a rare OS was detected. Investigate these spikes using the detailed anomaly table to identify the specific host and the rare OS.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"1030eaa7-9a19-4eb3-9c97-cc1c59e186f7\",\"gridData\":{\"i\":\"1030eaa7-9a19-4eb3-9c97-cc1c59e186f7\",\"y\":29,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[PM-5, CCI-004328, CCI-004329] ML - New Hosts Anomaly Score Trend\",\"panelRefName\":\"panel_f4df824b-227c-4d22-a6c3-90ba481c4727\",\"embeddableConfig\":{\"description\":\"This visualization displays the anomaly score over time for the ML job that detects an unusual increase in the number of unique hosts.\\n\\n**Why this visualization works:**\\nIt provides a continuous, automated check on your asset inventory baseline. A sudden spike in new hosts, flagged as an anomaly, could indicate unauthorized devices connecting to the network or a misconfiguration in asset provisioning. This is a leading indicator for maintaining inventory accuracy (CCI-004328).\\n\\n**How an analyst can use it:**\\nLook for spikes in the anomaly score. A high score suggests a significant deviation from the norm. Use the time selector to isolate these periods and investigate the corresponding detailed anomaly table to identify the specific hosts and their characteristics that contributed to the anomaly.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"f4df824b-227c-4d22-a6c3-90ba481c4727\",\"gridData\":{\"i\":\"f4df824b-227c-4d22-a6c3-90ba481c4727\",\"y\":44,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[PM-5, CCI-004328, CCI-004329] ML - Detailed New Host Anomalies\",\"panelRefName\":\"panel_df1beab5-c3ac-4216-bb7c-8672c3d8bd86\",\"embeddableConfig\":{\"description\":\"This table lists the specific anomalies detected when an unusual number of new hosts appeared on the network.\\n\\n**Why this visualization works:**\\nIt provides the granular details needed for an investigation, directly linking the anomaly to influencer fields like the OS family, cloud provider, or geographic location. This helps you quickly understand the context of the new hosts.\\n\\n**How an analyst can use it:**\\nWhen the trend chart shows a spike, use this table to see the details. Sort by 'anomaly_score' to prioritize the most significant events. Examine the influencer columns to identify patterns—for example, are all new hosts from a specific cloud provider or running an unexpected OS? This information is critical for validating your asset inventory (CCI-004329).\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"df1beab5-c3ac-4216-bb7c-8672c3d8bd86\",\"gridData\":{\"i\":\"df1beab5-c3ac-4216-bb7c-8672c3d8bd86\",\"y\":59,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[PM-5, CCI-004328, CCI-004329] ML - Hosts Stopped Reporting Anomaly Trend\",\"panelRefName\":\"panel_4186bb7e-ec4b-422f-9b49-2ed877a2c9ef\",\"embeddableConfig\":{\"description\":\"This chart displays the anomaly score over time for the ML job that detects when a host unexpectedly stops sending data.\\n\\n**Why this visualization works:**\\nIt helps validate your inventory by identifying assets that have gone silent (CCI-004329). A host that stops reporting could be offline due to a failure, or its monitoring agent could have been disabled, either accidentally or maliciously.\\n\\n**How an analyst can use it:**\\nLook for spikes in the anomaly score. Each spike represents a host (or group of hosts) that the ML model expected to see but didn't. Use the detailed table to find out which specific host stopped reporting.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"4186bb7e-ec4b-422f-9b49-2ed877a2c9ef\",\"gridData\":{\"i\":\"4186bb7e-ec4b-422f-9b49-2ed877a2c9ef\",\"y\":44,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-004328] Develop System Inventory ML\",\"panelRefName\":\"panel_a81b1336-491b-4f75-a968-20438047c900\",\"embeddableConfig\":{\"description\":\"This visualization displays the health status of system inventory development for CCI-004328 based on anomaly scores from associated ML jobs. These jobs detect undocumented assets, rare operating systems, and unmonitored assets. A green status indicates normal inventory activity, yellow indicates a minor anomaly, and red signifies a critical issue, such as a spike in new, unknown hosts, that requires immediate investigation.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"a81b1336-491b-4f75-a968-20438047c900\",\"gridData\":{\"i\":\"a81b1336-491b-4f75-a968-20438047c900\",\"y\":7,\"x\":0,\"w\":48,\"h\":7}},{\"type\":\"visualization\",\"title\":\"[PM-5, CCI-004328, CCI-004329] ML - Detailed Hosts Stopped Reporting Anomalies\",\"panelRefName\":\"panel_6e034f66-bffe-46f5-97c7-38e0b9bd624c\",\"embeddableConfig\":{\"description\":\"This table lists the specific anomalies for hosts that have stopped reporting to the network.\\n\\n**Why this visualization works:**\\nIt pinpoints the exact asset ('over_field_value') that has gone missing from your monitoring coverage. This is essential for maintaining an accurate and validated inventory (CCI-004329).\\n\\n**How an analyst can use it:**\\nAfter seeing a spike on the trend chart, come to this table. The 'over_field_value' column will show the name of the host that stopped reporting. Your task is to investigate why this host is silent. Is it decommissioned, experiencing an outage, or has its security agent been tampered with?\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"6e034f66-bffe-46f5-97c7-38e0b9bd624c\",\"gridData\":{\"i\":\"6e034f66-bffe-46f5-97c7-38e0b9bd624c\",\"y\":59,\"x\":24,\"w\":24,\"h\":15}}]","timeRestore":false,"title":"[CCI-004328]","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T19:39:51.265Z","created_by":"u_elastic_found","id":"65a26242-daf3-4ace-b813-a0a027a77a85","managed":false,"references":[{"id":"cci-004328-systems-table","name":"97d98858-7df4-4109-8445-e7292406104c:panel_97d98858-7df4-4109-8445-e7292406104c","type":"visualization"},{"id":"cci-004328-total-systems","name":"27b41d88-af81-445b-8891-b4fd6b617c33:panel_27b41d88-af81-445b-8891-b4fd6b617c33","type":"visualization"},{"id":"cci-004328-title","name":"239bb095-a16e-4eff-ab35-83ff44690e5a:panel_239bb095-a16e-4eff-ab35-83ff44690e5a","type":"visualization"},{"id":"pm-5-cci-004328-ml-rare-os-table","name":"88f8a931-a7c1-4527-9491-b0f4ae2f6ec7:panel_88f8a931-a7c1-4527-9491-b0f4ae2f6ec7","type":"visualization"},{"id":"pm-5-cci-004328-ml-rare-os-trend","name":"1030eaa7-9a19-4eb3-9c97-cc1c59e186f7:panel_1030eaa7-9a19-4eb3-9c97-cc1c59e186f7","type":"visualization"},{"id":"pm-5-cci-004328-004329-ml-new-hosts-trend","name":"f4df824b-227c-4d22-a6c3-90ba481c4727:panel_f4df824b-227c-4d22-a6c3-90ba481c4727","type":"visualization"},{"id":"pm-5-cci-004328-004329-ml-new-hosts-table","name":"df1beab5-c3ac-4216-bb7c-8672c3d8bd86:panel_df1beab5-c3ac-4216-bb7c-8672c3d8bd86","type":"visualization"},{"id":"pm-5-cci-004328-004329-ml-hosts-stopped-reporting-trend","name":"4186bb7e-ec4b-422f-9b49-2ed877a2c9ef:panel_4186bb7e-ec4b-422f-9b49-2ed877a2c9ef","type":"visualization"},{"id":"cci-004328-title-ml","name":"a81b1336-491b-4f75-a968-20438047c900:panel_a81b1336-491b-4f75-a968-20438047c900","type":"visualization"},{"id":"pm-5-cci-004328-004329-ml-hosts-stopped-reporting-table","name":"6e034f66-bffe-46f5-97c7-38e0b9bd624c:panel_6e034f66-bffe-46f5-97c7-38e0b9bd624c","type":"visualization"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","name":"tag-ref-30441975-ef53-4eee-8a2c-df8b8a9e0331","type":"tag"},{"id":"ba739d14-f0dc-4493-94f5-7e9ade4cb931","name":"tag-ref-ba739d14-f0dc-4493-94f5-7e9ade4cb931","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"logs-*","name":"97d98858-7df4-4109-8445-e7292406104c:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"27b41d88-af81-445b-8891-b4fd6b617c33:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"239bb095-a16e-4eff-ab35-83ff44690e5a:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"88f8a931-a7c1-4527-9491-b0f4ae2f6ec7:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"1030eaa7-9a19-4eb3-9c97-cc1c59e186f7:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"f4df824b-227c-4d22-a6c3-90ba481c4727:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"df1beab5-c3ac-4216-bb7c-8672c3d8bd86:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"4186bb7e-ec4b-422f-9b49-2ed877a2c9ef:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"a81b1336-491b-4f75-a968-20438047c900:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"ml-anomalies-index-pattern","name":"a81b1336-491b-4f75-a968-20438047c900:metrics_0_index_pattern","type":"index-pattern"},{"id":".ml-anomalies-*","name":"6e034f66-bffe-46f5-97c7-38e0b9bd624c:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-09-10T00:29:44.668Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk2NTAsN10="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":22,"missingRefCount":0,"missingReferences":[]}