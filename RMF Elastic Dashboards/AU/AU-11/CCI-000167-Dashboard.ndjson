{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T19:10:00.315Z","created_by":"u_elastic_found","id":".ml-anomalies-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-23T01:28:26.924Z","updated_by":"u_elastic_found","version":"WzE2MDMsMl0="}
{"attributes":{"color":"#1a936f","description":"Tag for RMF Control AU-11: Audit Record Retention","name":"au-11"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-31T02:22:21.405Z","created_by":"u_elastic_found","id":"au-11-tag","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-31T02:22:21.405Z","updated_by":"u_elastic_found","version":"WzM2NjgxLDdd"}
{"attributes":{"color":"#cde303","description":"","name":"rmf"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI2LDdd"}
{"attributes":{"color":"#c7f175","description":"","name":"compliance"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI3LDdd"}
{"attributes":{"color":"#0e431f","description":"","name":"ml"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:32:52.214Z","created_by":"u_elastic_found","id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T18:32:52.214Z","updated_by":"u_elastic_found","version":"WzMyNzcsMV0="}
{"attributes":{"description":"This visualization displays the maximum anomaly score over time for the job monitoring audit record ingestion rates. \n\n**Why this visualization works:** The ML job `au-11-cci-000167-ingestion-rate-job` is designed to learn the normal patterns of log ingestion. A spike in the anomaly score indicates an unusual change in the volume or source of ingested audit data. This could mean a log shipper has failed, a new data source has appeared, or an attacker is attempting to flood the system with data to obscure malicious activity. Rule-based alerts might miss these subtle deviations, but the ML job will flag them for investigation.\n\n**How an analyst can use it:** Look for any spikes in the anomaly score trend. A high score (e.g., 75 or above) warrants immediate investigation. Use the time range selector to narrow down the period of the anomaly. The `influencers` table below will help you identify the specific `host.name`, `event.dataset`, and `agent.type` associated with the anomalous behavior. This helps you quickly pinpoint the source of the ingestion issue to ensure compliance with CCI-000167.","state":{"adHocDataViews":{},"datasourceStates":{"formBased":{"layers":{"ce22de3a-842a-414b-9b87-140c9d0183a9":{"columnOrder":["93e26758-6a03-4928-999f-ad2611a76af6","6956c2b7-e302-48de-94a7-a4c598f05066"],"columns":{"6956c2b7-e302-48de-94a7-a4c598f05066":{"customLabel":true,"dataType":"number","isBucketed":false,"label":"Max anomaly_score","operationType":"max","params":{"emptyAsNull":true},"sourceField":"anomaly_score"},"93e26758-6a03-4928-999f-ad2611a76af6":{"customLabel":true,"dataType":"date","isBucketed":true,"label":"@timestamp","operationType":"date_histogram","params":{"dropPartials":false,"includeEmptyRows":false,"interval":"auto"},"sourceField":"@timestamp"}},"ignoreGlobalFilters":false,"incompleteColumns":{}}}},"indexpattern":{"layers":{}},"textBased":{"layers":{}}},"filters":[],"internalReferences":[],"query":{"language":"kuery","query":"job_id:au-11-cci-000167-ingestion-rate-job"},"visualization":{"axisTitlesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"curveType":"LINEAR","fittingFunction":"Linear","gridlinesVisibilitySettings":{"x":false,"yLeft":false,"yRight":true},"labelsOrientation":{"x":0,"yLeft":0,"yRight":-90},"layers":[{"accessors":["6956c2b7-e302-48de-94a7-a4c598f05066"],"isHistogram":true,"layerId":"ce22de3a-842a-414b-9b87-140c9d0183a9","layerType":"data","palette":{"name":"default","type":"palette"},"seriesType":"area_stacked","simpleView":false,"xAccessor":"93e26758-6a03-4928-999f-ad2611a76af6","xScaleType":"time","yConfig":[{"axisMode":"left","forAccessor":"6956c2b7-e302-48de-94a7-a4c598f05066"}]}],"legend":{"isVisible":true,"maxLines":1,"position":"right","shouldTruncate":true,"showSingleSeries":true},"preferredSeriesType":"bar_stacked","showCurrentTimeMarker":false,"tickLabelsVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"valueLabels":"hide","yLeftExtent":{"enforce":true,"mode":"full"},"yLeftScale":"linear","yRightScale":"linear","yTitle":""}},"title":"[AU-11, CCI-000167] ML - Audit Ingestion Rate Anomaly Score Trend","visualizationType":"lnsXY"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-02T13:05:29.832Z","created_by":"u_elastic_found","id":"f0415093-f0bc-436c-bdec-63ebec8072be","managed":false,"references":[{"id":".ml-anomalies-*","name":"indexpattern-datasource-layer-ce22de3a-842a-414b-9b87-140c9d0183a9","type":"index-pattern"},{"id":"au-11-tag","name":"tag-ref-au-11-tag","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"lens","typeMigrationVersion":"8.9.0","updated_at":"2025-08-02T13:05:29.832Z","updated_by":"u_elastic_found","version":"WzYyNDgsN10="}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"@timestamp\":{\"count\":1},\"agent.type\":{\"count\":8},\"event.action\":{\"count\":1},\"event.category\":{\"count\":8},\"event.dataset\":{\"count\":6},\"event.kind\":{\"count\":2},\"event.module\":{\"count\":6},\"event.outcome\":{\"count\":3},\"event.type\":{\"count\":1},\"file.path\":{\"count\":4},\"host.name\":{\"count\":1},\"message\":{\"count\":4},\"package.name\":{\"count\":1},\"package.version\":{\"count\":1},\"process.args\":{\"count\":1},\"process.command_line\":{\"count\":4},\"process.entity_id\":{\"count\":1},\"process.exit_code\":{\"count\":4},\"process.name\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":"logs-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":"logs-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T16:46:38.680Z","created_by":"u_elastic_found","id":"logs-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-08-07T04:07:01.675Z","updated_by":"u_elastic_found","version":"WzcxMjgsN10="}
{"attributes":{"color":"#d090b6","description":"","name":"au-11"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-31T01:07:57.757Z","created_by":"u_elastic_found","id":"445614b6-1ddb-4b0c-8130-3d9bd27e3413","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-31T01:07:57.757Z","updated_by":"u_elastic_found","version":"WzM2MTU3LDdd"}
{"attributes":{"color":"#f21b44","description":"","name":"mltitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:40:46.065Z","created_by":"u_elastic_found","id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:40:46.065Z","updated_by":"u_elastic_found","version":"WzQ2OTcsMl0="}
{"attributes":{"description":"This section provides visualizations to help you assess compliance with CCI-000167, which focuses on retaining audit records for a defined period. This visualization displays the health status of audit record retention for CCI-000167 based on the anomaly scores from associated ML jobs.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-11-cci-000167-ingestion-rate-job OR job_id:au-11-cci-000167-oldest-record-job\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000167] Audit Record Retention ML","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000167] Audit Record Retention ML\",\"type\":\"metrics\",\"aggs\":[],\"params\":{\"time_range_mode\":\"entire_time_range\",\"axis_formatter\":\"number\",\"axis_position\":\"left\",\"axis_scale\":\"normal\",\"background_color_rules\":[{\"value\":0,\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-green\",\"operator\":\"gte\"},{\"value\":20,\"background_color\":\"rgba(255,221,0,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-yellow\",\"operator\":\"gte\"},{\"value\":100,\"background_color\":\"rgba(249,3,3,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-red\",\"operator\":\"gte\"}],\"bar_color_rules\":[],\"drop_last_bucket\":0,\"filter\":{\"language\":\"kuery\",\"query\":\"job_id:au-11-cci-000167-ingestion-rate-job OR job_id:au-11-cci-000167-oldest-record-job\"},\"gauge_color_rules\":[],\"gauge_inner_width\":10,\"gauge_style\":\"half\",\"gauge_width\":10,\"id\":\"cci-000167-title\",\"interval\":\"\",\"isModelInvalid\":false,\"max_lines_legend\":1,\"series\":[{\"time_range_mode\":\"entire_time_range\",\"axis_position\":\"right\",\"chart_type\":\"line\",\"color\":\"#68BC00\",\"fill\":0.5,\"formatter\":\"0,0.[00]\",\"hidden\":false,\"id\":\"metric-1\",\"label\":\"CCI-000167 Health Status\",\"line_width\":1,\"metrics\":[{\"field\":\"anomaly_score\",\"id\":\"max-anomaly-score\",\"type\":\"max\"}],\"override_index_pattern\":0,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"point_size\":1,\"separate_axis\":0,\"series_drop_last_bucket\":0,\"split_mode\":\"everything\",\"stacked\":\"none\"}],\"show_grid\":1,\"show_legend\":1,\"time_field\":\"@timestamp\",\"tooltip_mode\":\"show_all\",\"truncate_legend\":1,\"type\":\"metric\",\"use_kibana_indexes\":true,\"index_pattern_ref_name\":\"metrics_0_index_pattern\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-02T12:58:24.152Z","created_by":"u_elastic_found","id":"cci-000167-title-ml","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"445614b6-1ddb-4b0c-8130-3d9bd27e3413","name":"tag-ref-445614b6-1ddb-4b0c-8130-3d9bd27e3413","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","name":"tag-ref-7dbb121c-e6c4-4063-88e0-37634f9b6a92","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":".ml-anomalies-*","name":"metrics_0_index_pattern","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-02T12:59:57.857Z","updated_by":"u_elastic_found","version":"WzYyMzIsN10="}
{"attributes":{"color":"#d4cfb9","description":"","name":"metrics"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI1LDdd"}
{"attributes":{"description":"This metric displays the timestamp of the most recent audit record found within the selected time range and data set.\n\n**Why this visualization works:**\nIt confirms that log ingestion is currently active and provides a definitive end-point for the retention period calculation.\n\n**How an analyst can use it:**\nThis date should be very close to the current time. [cite: 8] [cite_start]If the newest record is several hours or days old, it may indicate an issue with log collection agents or the ingestion pipeline for the selected component. [cite: 9] It confirms the system is 'live' and that data is being collected up to the present.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"event.kind: (*event* or *alert* or *signal* or *metric* or *state*) or event.category: (*authentication* or *configuration* or *database* or *driver* or *file* or *host* or *iam* or *intrusion_detection* or *malware* or *network* or *package* or *process* or *registry* or *session* or *threat* or *web*) or event.module: * or event.dataset: * or winlog.event_id: * or host.os.type: (*linux* or *macos* or *unix* or *windows*) or cloud.provider: *\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-11, CCI-000167] Newest Audit Record","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-11, CCI-000167] Newest Audit Record\",\"type\":\"metric\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"@timestamp\",\"customLabel\":\"Date of Newest Record\"},\"schema\":\"metric\"}],\"params\":{\"addLegend\":false,\"addTooltip\":true,\"dimensions\":{\"metrics\":[{\"accessor\":0,\"aggType\":\"max\",\"format\":{\"id\":\"date\"},\"params\":{}}]},\"metric\":{\"colorSchema\":\"Green to Red\",\"colorsRange\":[{\"from\":0,\"to\":10000}],\"labels\":{\"show\":true},\"metricColorMode\":\"None\",\"percentageMode\":false,\"style\":{\"bgColor\":false,\"fontSize\":40,\"subText\":\"\"},\"useRanges\":false},\"type\":\"metric\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-31T01:06:52.408Z","created_by":"u_elastic_found","id":"cci-000167-newest-record","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"445614b6-1ddb-4b0c-8130-3d9bd27e3413","name":"tag-ref-445614b6-1ddb-4b0c-8130-3d9bd27e3413","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-31T01:09:21.696Z","updated_by":"u_elastic_found","version":"WzUzMzksN10="}
{"attributes":{"description":"This metric displays the timestamp of the oldest audit record found within the selected time range and data set.\n\n**Why this visualization works:**\nIt provides an immediate, definitive starting point for your data retention period. [cite: 4] [cite_start]This date is the most critical piece of evidence for verifying long-term retention.\n\n**How an analyst can use it:**\nCompare this date to the current date to calculate the total retention duration. [cite: 5] [cite_start]For example, if today is January 1, 2025, and the oldest record is from January 1, 2024, you have at least 365 days of retention. [cite: 6] [cite_start]This should be checked against your organization's specific retention policy. [cite: 7] If the oldest record is more recent than your policy dictates, it signals a potential compliance gap.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"event.kind: (*event* or *alert* or *signal* or *metric* or *state*) or event.category: (*authentication* or *configuration* or *database* or *driver* or *file* or *host* or *iam* or *intrusion_detection* or *malware* or *network* or *package* or *process* or *registry* or *session* or *threat* or *web*) or event.module: * or event.dataset: * or winlog.event_id: * or host.os.type: (*linux* or *macos* or *unix* or *windows*) or cloud.provider: *\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-11, CCI-000167] Oldest Audit Record","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-11, CCI-000167] Oldest Audit Record\",\"type\":\"metric\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"min\",\"params\":{\"field\":\"@timestamp\",\"customLabel\":\"Date of Oldest Record\"},\"schema\":\"metric\"}],\"params\":{\"addTooltip\":true,\"addLegend\":false,\"type\":\"metric\",\"metric\":{\"percentageMode\":false,\"useRanges\":false,\"colorSchema\":\"Green to Red\",\"metricColorMode\":\"None\",\"colorsRange\":[{\"from\":0,\"to\":10000}],\"labels\":{\"show\":true},\"style\":{\"fontSize\":40,\"subText\":\"\",\"bgColor\":false}},\"dimensions\":{\"metrics\":[{\"accessor\":0,\"format\":{\"id\":\"date\"},\"params\":{},\"aggType\":\"min\"}]}}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-31T01:06:52.408Z","created_by":"u_elastic_found","id":"cci-000167-oldest-record","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"445614b6-1ddb-4b0c-8130-3d9bd27e3413","name":"tag-ref-445614b6-1ddb-4b0c-8130-3d9bd27e3413","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-31T01:08:29.266Z","updated_by":"u_elastic_found","version":"WzUzMzcsN10="}
{"attributes":{"description":"This visualization displays the maximum anomaly score over time for the job monitoring audit record retention. \n\n**Why this visualization works:** The ML job `au-11-cci-000167-oldest-record-job` establishes a baseline for the number of older audit records over time. An anomaly in this trend, particularly a sudden drop in the `low_count` of older records, is a direct indicator of a potential retention issue or premature deletion of audit logs. This is a critical check for CCI-000167, which requires that audit records are retained for a specific period. The ML model is particularly useful for detecting subtle, non-rule-based deletions or data purging events.\n\n**How an analyst can use it:** Monitor for any spikes in the anomaly score. A high score suggests that an unusual number of older audit records have been removed or are no longer being ingested, which is a compliance failure. Use the time selector to investigate the specific period of the anomaly. Use the `influencers` table below to identify which `host.name` or `event.dataset` is responsible for the anomaly. This will help you determine if an authorized retention policy was executed or if there was an unauthorized deletion of records.","state":{"adHocDataViews":{},"datasourceStates":{"formBased":{"layers":{"6690deae-59bd-4daf-9a18-e7a7d7b93db8":{"columnOrder":["977b25da-895d-4b1b-bc93-a1b10fac6999","d4c73a4d-2814-41d3-a1a5-f922f109c4ea"],"columns":{"977b25da-895d-4b1b-bc93-a1b10fac6999":{"customLabel":true,"dataType":"date","isBucketed":true,"label":"@timestamp","operationType":"date_histogram","params":{"dropPartials":false,"includeEmptyRows":false,"interval":"auto"},"sourceField":"@timestamp"},"d4c73a4d-2814-41d3-a1a5-f922f109c4ea":{"customLabel":true,"dataType":"number","isBucketed":false,"label":"Max anomaly_score","operationType":"max","params":{"emptyAsNull":true},"sourceField":"anomaly_score"}},"ignoreGlobalFilters":false,"incompleteColumns":{}}}},"indexpattern":{"layers":{}},"textBased":{"layers":{}}},"filters":[],"internalReferences":[],"query":{"language":"kuery","query":"job_id:au-11-cci-000167-oldest-record-job"},"visualization":{"axisTitlesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"curveType":"LINEAR","fittingFunction":"Linear","gridlinesVisibilitySettings":{"x":false,"yLeft":false,"yRight":true},"labelsOrientation":{"x":0,"yLeft":0,"yRight":-90},"layers":[{"accessors":["d4c73a4d-2814-41d3-a1a5-f922f109c4ea"],"isHistogram":true,"layerId":"6690deae-59bd-4daf-9a18-e7a7d7b93db8","layerType":"data","palette":{"name":"default","type":"palette"},"seriesType":"area_stacked","simpleView":false,"xAccessor":"977b25da-895d-4b1b-bc93-a1b10fac6999","xScaleType":"time","yConfig":[{"axisMode":"left","forAccessor":"d4c73a4d-2814-41d3-a1a5-f922f109c4ea"}]}],"legend":{"isVisible":true,"maxLines":1,"position":"right","shouldTruncate":true,"showSingleSeries":true},"preferredSeriesType":"bar_stacked","showCurrentTimeMarker":false,"tickLabelsVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"valueLabels":"hide","yLeftExtent":{"enforce":true,"mode":"full"},"yLeftScale":"linear","yRightScale":"linear","yTitle":""}},"title":"[AU-11, CCI-000167] ML - Audit Retention Anomaly Score Trend (converted)","visualizationType":"lnsXY"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-02T13:03:01.557Z","created_by":"u_elastic_found","id":"6969f7b6-5260-40bb-89d9-1dc58ac23cd3","managed":false,"references":[{"id":".ml-anomalies-*","name":"indexpattern-datasource-layer-6690deae-59bd-4daf-9a18-e7a7d7b93db8","type":"index-pattern"},{"id":"445614b6-1ddb-4b0c-8130-3d9bd27e3413","name":"tag-ref-445614b6-1ddb-4b0c-8130-3d9bd27e3413","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"lens","typeMigrationVersion":"8.9.0","updated_at":"2025-08-02T13:03:01.557Z","updated_by":"u_elastic_found","version":"WzYyNDIsN10="}
{"attributes":{"description":"This table provides a retention breakdown for each log source, showing the oldest and newest record for each one.\n\n**Why this visualization works:**\nIt offers granular proof of retention across your entire technology stack. [cite: 10] [cite_start]A single 'Oldest Record' metric might be skewed by one long-lived data source, while this table ensures that all sources are meeting compliance mandates individually.\n\n**How an analyst can use it:**\nSort the table by the 'Oldest Record' column. [cite: 11] [cite_start]Look for data sources with an oldest record date that is much more recent than others. [cite: 12] [cite_start]This is a red flag indicating that the retention policy for that specific data source may not be working correctly or that the source stopped sending logs for a period. [cite: 13] This is the most effective way to find component-level retention failures.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"event.kind: (*event* or *alert* or *signal* or *metric* or *state*) or event.category: (*authentication* or *configuration* or *database* or *driver* or *file* or *host* or *iam* or *intrusion_detection* or *malware* or *network* or *package* or *process* or *registry* or *session* or *threat* or *web*) or event.module: * or event.dataset: * or winlog.event_id: * or host.os.type: (*linux* or *macos* or *unix* or *windows*) or cloud.provider: *\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-11, CCI-000167] Audit Record Retention by Data Source","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-11, CCI-000167] Audit Record Retention by Data Source\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"min\",\"params\":{\"field\":\"@timestamp\",\"customLabel\":\"Oldest Record\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"@timestamp\",\"customLabel\":\"Newest Record\"},\"schema\":\"metric\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"data_stream.dataset\",\"orderBy\":\"1\",\"order\":\"asc\",\"size\":25,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"autoFitRowToContent\":false,\"perPage\":25,\"percentageCol\":\"\",\"showMetricsAtAllLevels\":true,\"showPartialRows\":false,\"showToolbar\":false,\"showTotal\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"totalFunc\":\"sum\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-31T01:06:52.408Z","created_by":"u_elastic_found","id":"cci-000167-retention-by-source","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"445614b6-1ddb-4b0c-8130-3d9bd27e3413","name":"tag-ref-445614b6-1ddb-4b0c-8130-3d9bd27e3413","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-31T01:09:35.473Z","updated_by":"u_elastic_found","version":"WzUzNDAsN10="}
{"attributes":{"color":"#f8bfc4","description":"","name":"dashboard"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-25T21:49:36.527Z","created_by":"u_elastic_found","id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-25T21:49:36.527Z","updated_by":"u_elastic_found","version":"WzI2MzUxLDNd"}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"lens\",\"panelRefName\":\"panel_87dfe663-73bf-44c8-b849-a262e302bd9b\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-11-cci-000167-ingestion-rate-job\"}},\"panelIndex\":\"87dfe663-73bf-44c8-b849-a262e302bd9b\",\"gridData\":{\"i\":\"87dfe663-73bf-44c8-b849-a262e302bd9b\",\"y\":27,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-000167] Audit Record Retention ML\",\"panelRefName\":\"panel_618fed34-10d5-41b0-a67b-685dad9a6de5\",\"embeddableConfig\":{\"description\":\"This section provides visualizations to help you assess compliance with CCI-000167, which focuses on retaining audit records for a defined period. This visualization displays the health status of audit record retention for CCI-000167 based on the anomaly scores from associated ML jobs.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"618fed34-10d5-41b0-a67b-685dad9a6de5\",\"gridData\":{\"i\":\"618fed34-10d5-41b0-a67b-685dad9a6de5\",\"y\":0,\"x\":0,\"w\":48,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[AU-11, CCI-000167] Newest Audit Record\",\"panelRefName\":\"panel_2c78c61d-c285-4383-91bb-ef6d13293bc3\",\"embeddableConfig\":{\"description\":\"This metric displays the timestamp of the most recent audit record found within the selected time range and data set.\\n\\n**Why this visualization works:**\\nIt confirms that log ingestion is currently active and provides a definitive end-point for the retention period calculation.\\n\\n**How an analyst can use it:**\\nThis date should be very close to the current time. [cite: 8] [cite_start]If the newest record is several hours or days old, it may indicate an issue with log collection agents or the ingestion pipeline for the selected component. [cite: 9] It confirms the system is 'live' and that data is being collected up to the present.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"2c78c61d-c285-4383-91bb-ef6d13293bc3\",\"gridData\":{\"i\":\"2c78c61d-c285-4383-91bb-ef6d13293bc3\",\"y\":21,\"x\":0,\"w\":48,\"h\":6}},{\"type\":\"visualization\",\"title\":\"[AU-11, CCI-000167] Oldest Audit Record\",\"panelRefName\":\"panel_27fc5d99-04fc-40d9-9e42-971b675010a4\",\"embeddableConfig\":{\"description\":\"This metric displays the timestamp of the oldest audit record found within the selected time range and data set.\\n\\n**Why this visualization works:**\\nIt provides an immediate, definitive starting point for your data retention period. [cite: 4] [cite_start]This date is the most critical piece of evidence for verifying long-term retention.\\n\\n**How an analyst can use it:**\\nCompare this date to the current date to calculate the total retention duration. [cite: 5] [cite_start]For example, if today is January 1, 2025, and the oldest record is from January 1, 2024, you have at least 365 days of retention. [cite: 6] [cite_start]This should be checked against your organization's specific retention policy. [cite: 7] If the oldest record is more recent than your policy dictates, it signals a potential compliance gap.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"27fc5d99-04fc-40d9-9e42-971b675010a4\",\"gridData\":{\"i\":\"27fc5d99-04fc-40d9-9e42-971b675010a4\",\"y\":15,\"x\":0,\"w\":48,\"h\":6}},{\"type\":\"lens\",\"panelRefName\":\"panel_f1db61c3-d1a9-4b89-b50f-3c4f8c98e4de\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-11-cci-000167-oldest-record-job\"}},\"panelIndex\":\"f1db61c3-d1a9-4b89-b50f-3c4f8c98e4de\",\"gridData\":{\"i\":\"f1db61c3-d1a9-4b89-b50f-3c4f8c98e4de\",\"y\":27,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[AU-11, CCI-000167] Audit Record Retention by Data Source\",\"panelRefName\":\"panel_e01c2eee-2061-4e75-8541-fcc8f4485017\",\"embeddableConfig\":{\"description\":\"This table provides a retention breakdown for each log source, showing the oldest and newest record for each one.\\n\\n**Why this visualization works:**\\nIt offers granular proof of retention across your entire technology stack. [cite: 10] [cite_start]A single 'Oldest Record' metric might be skewed by one long-lived data source, while this table ensures that all sources are meeting compliance mandates individually.\\n\\n**How an analyst can use it:**\\nSort the table by the 'Oldest Record' column. [cite: 11] [cite_start]Look for data sources with an oldest record date that is much more recent than others. [cite: 12] [cite_start]This is a red flag indicating that the retention policy for that specific data source may not be working correctly or that the source stopped sending logs for a period. [cite: 13] This is the most effective way to find component-level retention failures.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"e01c2eee-2061-4e75-8541-fcc8f4485017\",\"gridData\":{\"i\":\"e01c2eee-2061-4e75-8541-fcc8f4485017\",\"y\":42,\"x\":0,\"w\":48,\"h\":21}}]","timeRestore":false,"title":"AU-11 CCI-000167","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-08-02T13:01:41.806Z","created_by":"u_elastic_found","id":"5e7b9495-f24b-4685-8c67-ff7fdc20435f","managed":false,"references":[{"id":"f0415093-f0bc-436c-bdec-63ebec8072be","name":"87dfe663-73bf-44c8-b849-a262e302bd9b:panel_87dfe663-73bf-44c8-b849-a262e302bd9b","type":"lens"},{"id":"cci-000167-title-ml","name":"618fed34-10d5-41b0-a67b-685dad9a6de5:panel_618fed34-10d5-41b0-a67b-685dad9a6de5","type":"visualization"},{"id":"cci-000167-newest-record","name":"2c78c61d-c285-4383-91bb-ef6d13293bc3:panel_2c78c61d-c285-4383-91bb-ef6d13293bc3","type":"visualization"},{"id":"cci-000167-oldest-record","name":"27fc5d99-04fc-40d9-9e42-971b675010a4:panel_27fc5d99-04fc-40d9-9e42-971b675010a4","type":"visualization"},{"id":"6969f7b6-5260-40bb-89d9-1dc58ac23cd3","name":"f1db61c3-d1a9-4b89-b50f-3c4f8c98e4de:panel_f1db61c3-d1a9-4b89-b50f-3c4f8c98e4de","type":"lens"},{"id":"cci-000167-retention-by-source","name":"e01c2eee-2061-4e75-8541-fcc8f4485017:panel_e01c2eee-2061-4e75-8541-fcc8f4485017","type":"visualization"},{"id":"445614b6-1ddb-4b0c-8130-3d9bd27e3413","name":"tag-ref-445614b6-1ddb-4b0c-8130-3d9bd27e3413","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","name":"tag-ref-30441975-ef53-4eee-8a2c-df8b8a9e0331","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":".ml-anomalies-*","name":"87dfe663-73bf-44c8-b849-a262e302bd9b:indexpattern-datasource-layer-ce22de3a-842a-414b-9b87-140c9d0183a9","type":"index-pattern"},{"id":"logs-*","name":"618fed34-10d5-41b0-a67b-685dad9a6de5:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"618fed34-10d5-41b0-a67b-685dad9a6de5:metrics_0_index_pattern","type":"index-pattern"},{"id":"logs-*","name":"2c78c61d-c285-4383-91bb-ef6d13293bc3:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"27fc5d99-04fc-40d9-9e42-971b675010a4:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"f1db61c3-d1a9-4b89-b50f-3c4f8c98e4de:indexpattern-datasource-layer-6690deae-59bd-4daf-9a18-e7a7d7b93db8","type":"index-pattern"},{"id":"logs-*","name":"e01c2eee-2061-4e75-8541-fcc8f4485017:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-08-02T13:13:39.441Z","updated_by":"u_elastic_found","version":"WzYyNzcsN10="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":17,"missingRefCount":0,"missingReferences":[]}