{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T19:10:00.315Z","created_by":"u_elastic_found","id":".ml-anomalies-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-23T01:28:26.924Z","updated_by":"u_elastic_found","version":"WzE2MDMsMl0="}
{"attributes":{"color":"#5c20a7","description":"","name":"au-12"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-06T04:04:06.594Z","created_by":"u_elastic_found","id":"b8021d80-2ada-40e9-82cb-cb85d7225fa6","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-08-06T04:04:06.594Z","updated_by":"u_elastic_found","version":"WzQ4NzgzLDdd"}
{"attributes":{"color":"#cde303","description":"","name":"rmf"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI2LDdd"}
{"attributes":{"color":"#c7f175","description":"","name":"compliance"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI3LDdd"}
{"attributes":{"color":"#0e431f","description":"","name":"ml"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:32:52.214Z","created_by":"u_elastic_found","id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T18:32:52.214Z","updated_by":"u_elastic_found","version":"WzMyNzcsMV0="}
{"attributes":{"description":"**Why and When:** This table is your primary tool for investigating rare audit configuration change anomalies identified by the trend chart. It provides the necessary context to determine if a change was an authorized risk adjustment (compliant with CCI-000172) or a potential security incident.\n\n**How to Use:** After identifying a time of interest, filter this table to that timeframe. The `by_field_value` column will tell you the exact `event.action` that was anomalous. Examine the `influencers.user.name` and `influencers.process.command_line` fields to understand who made the change and how. This information is critical for verifying the change against change management records.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-12-cci-000172-rare-audit-config-change\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-12, CCI-000172] ML - Detailed Rare Config Change Anomalies","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-12, CCI-000172] ML - Detailed Rare Config Change Anomalies\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\",\"customLabel\":\"Max Anomaly Score\"},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"by_field_value\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true,\"customLabel\":\"Anomalous Action\"},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"5\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"user.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"6\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"process.command_line\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-29T22:31:03.270Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"au-12-cci-000172-ml-detailed-anomalies","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"b8021d80-2ada-40e9-82cb-cb85d7225fa6","name":"tag-ref-b8021d80-2ada-40e9-82cb-cb85d7225fa6","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-06T23:40:22.250Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzgyNzYsN10="}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"@timestamp\":{\"count\":1},\"agent.type\":{\"count\":8},\"event.action\":{\"count\":1},\"event.category\":{\"count\":8},\"event.dataset\":{\"count\":6},\"event.kind\":{\"count\":2},\"event.module\":{\"count\":6},\"event.outcome\":{\"count\":3},\"event.type\":{\"count\":1},\"file.path\":{\"count\":4},\"host.name\":{\"count\":1},\"message\":{\"count\":4},\"package.name\":{\"count\":1},\"package.version\":{\"count\":1},\"process.args\":{\"count\":1},\"process.command_line\":{\"count\":4},\"process.entity_id\":{\"count\":1},\"process.exit_code\":{\"count\":4},\"process.name\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":"logs-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":"logs-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T16:46:38.680Z","created_by":"u_elastic_found","id":"logs-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-08-07T04:07:01.675Z","updated_by":"u_elastic_found","version":"WzcxMjgsN10="}
{"attributes":{"color":"#d4cfb9","description":"","name":"metrics"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI1LDdd"}
{"attributes":{"description":"This control requires demonstrating that the level of audit review, analysis, and reporting is adjusted in response to a change in risk. [cite_start]These visualizations help you gather evidence of such adjustments. [cite: 282]\n\n**Analyst Guidance:**\nCompliance with CCI-000172 is demonstrated by correlating an external risk change (e.g., a new threat actor, a critical vulnerability disclosure) with an internal change in audit posture. [cite_start]Your task is to prove this connection. [cite: 283]\n\n1.  [cite_start]**Identify a Risk Event:** Pinpoint a specific date/time when your organization recognized a change in risk that should have prompted an adjustment in auditing. [cite: 283]\n2.  [cite_start]**Filter for Components:** Use the dashboard's global filters (e.g., `host.name: <your_component_name>` or `data_stream.dataset: <your_dataset>`) to focus on the systems or services affected by the risk change. [cite: 284]\n3.  **Analyze Trends:** Use the 'Audit Event Volume Trend' visualization to see if there was a noticeable increase in log volume for the affected components after the risk event. [cite_start]A sustained increase is evidence of enhanced logging. [cite: 285, 286]\n4.  **Verify Policy Changes:** The 'Audit Policy & Configuration Changes' table is your most direct evidence. [cite_start]Look for events immediately following the risk event that show new audit rules being loaded (`auditctl`), policies being applied (`auditpol.exe`), or configuration files being modified. [cite: 286, 287]\n5.  **Compare Event Types:** Use the 'Audit Event Type Breakdown' to compare the distribution of event types *before* and *after* the risk event. [cite_start]A change in the distribution (e.g., a shift from monitoring logins to monitoring file integrity) demonstrates a qualitative adjustment to auditing. [cite: 288, 289]","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000172] Audit Generation - Adjusting Audit Levels in Response to Risk","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000172] Audit Generation - Adjusting Audit Levels in Response to Risk\",\"type\":\"markdown\",\"aggs\":[],\"params\":{\"markdown\":\"# [CCI-000172] Audit Generation\\n\\n### Adjusting audit levels in response to risk.\",\"fontSize\":12,\"openLinksInNewTab\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T04:13:04.048Z","created_by":"u_elastic_found","id":"cci-000172-title","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"b8021d80-2ada-40e9-82cb-cb85d7225fa6","name":"tag-ref-b8021d80-2ada-40e9-82cb-cb85d7225fa6","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-07T04:13:04.048Z","updated_by":"u_elastic_found","version":"WzcxNTMsN10="}
{"attributes":{"color":"#f21b44","description":"","name":"mltitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:40:46.065Z","created_by":"u_elastic_found","id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:40:46.065Z","updated_by":"u_elastic_found","version":"WzQ2OTcsMl0="}
{"attributes":{"description":"This visualization displays the health status for CCI-000172, adjusting audit levels in response to risk, based on the anomaly scores from the associated ML job. A high score indicates rare or unusual audit configuration changes that may require investigation.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}"},"title":"[CCI-000172] Audit Generation - Adjusting Audit Levels in Response to Risk ML","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000172] Audit Generation - Adjusting Audit Levels in Response to Risk ML\",\"type\":\"metrics\",\"aggs\":[],\"params\":{\"axis_formatter\":\"number\",\"axis_position\":\"left\",\"axis_scale\":\"normal\",\"background_color_rules\":[{\"id\":\"284b80b0-4e8c-11ef-9b1c-c510e144e33c\",\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"operator\":\"gte\",\"value\":0},{\"id\":\"2b9921e0-4e8c-11ef-9b1c-c510e144e33c\",\"background_color\":\"rgba(255,221,0,1)\",\"color\":\"rgba(0,0,0,1)\",\"operator\":\"gte\",\"value\":20},{\"id\":\"30321aa0-4e8c-11ef-9b1c-c510e144e33c\",\"background_color\":\"rgba(249,3,3,1)\",\"color\":\"rgba(0,0,0,1)\",\"operator\":\"gte\",\"value\":100},{\"id\":\"0ac181a4-a734-44c4-a8b0-07863ddbdf74\",\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"operator\":\"empty\",\"value\":null}],\"bar_color_rules\":[{\"id\":\"34890250-4e8c-11ef-9b1c-c510e144e33c\"}],\"filter\":{\"language\":\"kuery\",\"query\":\"job_id:au-12-cci-000172-rare-audit-config-change\"},\"gauge_color_rules\":[{\"id\":\"32540f20-4e8c-11ef-9b1c-c510e144e33c\"}],\"id\":\"2411e860-4e8c-11ef-9b1c-c510e144e33c\",\"index_pattern\":\".ml-anomalies-*\",\"interval_string\":\"auto\",\"series\":[{\"id\":\"2411e861-4e8c-11ef-9b1c-c510e144e33c\",\"metrics\":[{\"id\":\"2411e862-4e8c-11ef-9b1c-c510e144e33c\",\"type\":\"max\",\"field\":\"anomaly_score\"}],\"split_mode\":\"everything\",\"split_color_mode\":\"gradient\"}],\"show_grid\":1,\"show_legend\":1,\"time_field\":\"@timestamp\",\"time_range_mode\":\"entire_time_range\",\"type\":\"metric\",\"use_kibana_indexes\":false,\"panel_template\":\"{{#markdown}}\\n### [CCI-000172] Audit Generation - Adjusting Audit Levels in Response to Risk\\n{{/markdown}}\",\"hide_last_value_indicator\":true,\"drop_last_bucket\":1,\"interval\":\"\",\"truncate_legend\":1,\"max_lines_legend\":1,\"tooltip_mode\":\"show_all\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-30T13:51:26.405Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"cci-000172-title-ml","managed":false,"references":[{"id":"b8021d80-2ada-40e9-82cb-cb85d7225fa6","name":"tag-ref-b8021d80-2ada-40e9-82cb-cb85d7225fa6","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","name":"tag-ref-7dbb121c-e6c4-4063-88e0-37634f9b6a92","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-09-06T23:13:07.213Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"WzgyMTEsN10="}
{"attributes":{"description":"**Why and When:** This table provides the most direct evidence of compliance. [cite: 295] It captures the specific events where an administrator or automated process actively changed the audit configuration on a system. [cite_start]Look for these events immediately following a known change in risk. [cite: 295, 296]\n\n**How an Analyst Can Use It:**\n1. [cite_start]Use the time filter to narrow your search to the period just after the risk event occurred. [cite: 297]\n2. [cite_start]Filter by `host.name` to focus on the relevant systems. [cite: 298]\n3. Examine the results for processes like `auditctl` (Linux rule loading), `auditpol.exe` (Windows policy change), or modifications to key configuration files (e.g., `filebeat.yml`).\n4. [cite_start]The `user.name`, `process.command_line`, and `@timestamp` fields provide a clear record of who made what change and when. [cite: 299] [cite_start]This is your 'smoking gun' evidence. [cite: 300]","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"((event.category:(configuration OR policy) AND event.type:(change OR creation OR update))) OR (winlog.event_id:(4719 OR 4715 OR 4902 OR 4907 OR 1102)) OR (process.name:(auditctl OR augenrules OR auditpol.exe OR wevtutil.exe OR reg.exe OR sc.exe) AND event.category:process AND event.type:start) OR (process.name:powershell.exe AND process.command_line:(*Set-AuditRule* OR *New-NetFirewallRule* OR *Set-NetFirewallRule* OR *-ExecutionPolicy*)) OR (file.path:(\\\"/etc/audit/rules.d/*\\\" OR \\\"/etc/audit/auditd.conf\\\" OR \\\"/etc/rsyslog.conf\\\" OR \\\"/etc/syslog-ng.conf\\\" OR \\\"*filebeat.yml\\\" OR \\\"*winlogbeat.yml\\\" OR \\\"*auditbeat.yml\\\" OR \\\"*osquery.conf\\\") AND event.action:(file_change OR file_create OR file_modify OR file_rename)) OR (registry.path:(\\\"HKLM\\\\\\\\SYSTEM\\\\\\\\CurrentControlSet\\\\\\\\Services\\\\\\\\EventLog\\\\\\\\*\\\" OR \\\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Policies\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\EventLog\\\\\\\\*\\\" OR \\\"HKLM\\\\\\\\SOFTWARE\\\\\\\\Elastic\\\\\\\\*\\\") AND event.type:(change OR creation OR deletion)) OR ((cloud.service.name:CloudTrail AND event.action:UpdateTrail) OR (cloud.service.name:(\\\"GCP Audit Logs\\\" OR \\\"Azure Activity Logs\\\") AND event.action:(*.update OR *.write OR *.create OR *.patch) AND (resource.type:(*audit* OR *log* OR *monitor*) OR event.summary:(*audit* OR *log* OR *monitor* OR *diagnostic*))))\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000172] Audit Policy & Configuration Changes","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000172] Audit Policy & Configuration Changes\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"customLabel\":\"Change Events\",\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":20,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.name\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"-\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"user.name\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"-\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"5\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"process.name\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"-\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"6\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"process.command_line\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"-\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"7\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"file.path\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":true,\"missingBucketLabel\":\"-\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":false,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T04:13:04.048Z","created_by":"u_elastic_found","id":"cci-000172-policy-changes-table","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"b8021d80-2ada-40e9-82cb-cb85d7225fa6","name":"tag-ref-b8021d80-2ada-40e9-82cb-cb85d7225fa6","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-07T04:13:04.048Z","updated_by":"u_elastic_found","version":"WzcxNTUsN10="}
{"attributes":{"description":"**Why and When:** This visualization demonstrates a qualitative shift in audit focus. [cite_start]If a new risk involves file integrity, you should see an increase in `file_modify` or `file_access` events. [cite: 290] [cite_start]This shows that the audit adjustment was not just about volume, but about collecting more relevant data. [cite: 291]\n\n**How an Analyst Can Use It:**\n1. [cite_start]Select a time range *before* the risk event. [cite: 292] [cite_start]Note the percentage breakdown of the top event actions. [cite: 292]\n2. [cite_start]Select a time range *after* the risk event. [cite: 293]\n3. Compare the two breakdowns. [cite_start]A significant change in the distribution of event actions (e.g., `file_change` events becoming more prominent) provides strong evidence that the audit focus was adjusted to meet the new risk. [cite: 294]","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"query\":\"((event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata OR o365 OR gcp OR azure) OR event.dataset:(*.audit OR *.system OR *.security OR *.application OR *.firewall OR *.cloud OR *.network OR *.process OR *.file)) OR (file.path:(\\\"/var/log/audit/*\\\" OR \\\"/var/log/secure\\\" OR \\\"/var/log/auth.log\\\" OR \\\"/var/log/syslog\\\" OR \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\winevt\\\\\\\\Logs\\\\\\\\*\\\") OR file.extension:(log OR evtx OR json OR xml)) OR (cloud.service.name:(\\\"CloudTrail\\\" OR \\\"Azure Activity Logs\\\" OR \\\"GCP Audit Logs\\\" OR \\\"Kubernetes\\\")) OR (event.category:(file OR process OR registry OR network OR iam OR authentication OR configuration OR policy OR database OR web)))\",\"language\":\"kuery\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-000172] Audit Event Type Breakdown (Before vs. After)","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-000172] Audit Event Type Breakdown (Before vs. After)\",\"type\":\"pie\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"segment\"}],\"params\":{\"addTooltip\":true,\"addLegend\":true,\"legendPosition\":\"right\",\"isDonut\":true,\"type\":\"pie\",\"legendDisplay\":\"hide\",\"nestedLegend\":false,\"truncateLegend\":true,\"maxLegendLines\":1,\"distinctColors\":false,\"emptySizeRatio\":0.3,\"palette\":{\"type\":\"palette\",\"name\":\"default\"},\"labels\":{\"show\":true,\"last_level\":false,\"values\":true,\"valuesFormat\":\"percent\",\"percentDecimals\":2,\"truncate\":100,\"position\":\"default\"}}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T04:13:04.048Z","created_by":"u_elastic_found","id":"cci-000172-event-breakdown-pie","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"b8021d80-2ada-40e9-82cb-cb85d7225fa6","name":"tag-ref-b8021d80-2ada-40e9-82cb-cb85d7225fa6","type":"tag"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-08-07T04:13:04.048Z","updated_by":"u_elastic_found","version":"WzcxNTQsN10="}
{"attributes":{"color":"#f8bfc4","description":"","name":"dashboard"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-25T21:49:36.527Z","created_by":"u_elastic_found","id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-25T21:49:36.527Z","updated_by":"u_elastic_found","version":"WzI2MzUxLDNd"}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"visualization\",\"title\":\"[AU-12, CCI-000172] ML - Detailed Rare Config Change Anomalies\",\"panelRefName\":\"panel_26723801-4cbd-420e-adb4-27dcdd0161a8\",\"embeddableConfig\":{\"description\":\"**Why and When:** This table is your primary tool for investigating rare audit configuration change anomalies identified by the trend chart. It provides the necessary context to determine if a change was an authorized risk adjustment (compliant with CCI-000172) or a potential security incident.\\n\\n**How to Use:** After identifying a time of interest, filter this table to that timeframe. The `by_field_value` column will tell you the exact `event.action` that was anomalous. Examine the `influencers.user.name` and `influencers.process.command_line` fields to understand who made the change and how. This information is critical for verifying the change against change management records.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"26723801-4cbd-420e-adb4-27dcdd0161a8\",\"gridData\":{\"i\":\"26723801-4cbd-420e-adb4-27dcdd0161a8\",\"y\":43,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"[AU-12, CCI-000172] ML - Rare Config Change Anomaly Score Trend (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-12-cci-000172-rare-audit-config-change\"},\"attributes\":{\"title\":\"[AU-12, CCI-000172] ML - Rare Config Change Anomaly Score Trend (converted)\",\"description\":\"**Why and When:** Use this visualization to monitor for rare and potentially unauthorized audit configuration changes, directly supporting CCI-000172. The ML job learns what configuration changes are normal. This chart will highlight any activity that deviates from that learned behavior, which could represent a risk adjustment, a misconfiguration, or a malicious attempt to weaken audit controls.\\n\\n**How to Use:** Any spike in the anomaly score is a high-priority event. A high score indicates that a type of configuration change has occurred that is highly unusual. Use the time selector to isolate the anomaly and then pivot to the 'Detailed Rare Config Change Anomalies' table for investigation.\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\".ml-anomalies-*\",\"name\":\"indexpattern-datasource-layer-041f5ad7-dbac-4d24-af59-2118a19a9f10\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"legendSize\":\"auto\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"041f5ad7-dbac-4d24-af59-2118a19a9f10\",\"accessors\":[\"d39f84b0-8f12-496a-9339-22196013900e\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"791d2730-0193-4c5c-9fa8-9c4eda4dfff7\",\"simpleView\":false,\"palette\":{\"type\":\"palette\",\"name\":\"default\"},\"yConfig\":[{\"forAccessor\":\"d39f84b0-8f12-496a-9339-22196013900e\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-12-cci-000172-rare-audit-config-change\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"041f5ad7-dbac-4d24-af59-2118a19a9f10\":{\"ignoreGlobalFilters\":false,\"columns\":{\"791d2730-0193-4c5c-9fa8-9c4eda4dfff7\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"d39f84b0-8f12-496a-9339-22196013900e\":{\"label\":\"Max anomaly_score\",\"dataType\":\"number\",\"operationType\":\"max\",\"sourceField\":\"anomaly_score\",\"isBucketed\":false,\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"791d2730-0193-4c5c-9fa8-9c4eda4dfff7\",\"d39f84b0-8f12-496a-9339-22196013900e\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"a29e5b80-5153-41b7-803e-de885f06f383\",\"gridData\":{\"i\":\"a29e5b80-5153-41b7-803e-de885f06f383\",\"y\":43,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[CCI-000172] Audit Generation - Adjusting Audit Levels in Response to Risk\",\"panelRefName\":\"panel_3582613c-8ab9-461a-a3ce-8ad54a542962\",\"embeddableConfig\":{\"description\":\"This control requires demonstrating that the level of audit review, analysis, and reporting is adjusted in response to a change in risk. [cite_start]These visualizations help you gather evidence of such adjustments. [cite: 282]\\n\\n**Analyst Guidance:**\\nCompliance with CCI-000172 is demonstrated by correlating an external risk change (e.g., a new threat actor, a critical vulnerability disclosure) with an internal change in audit posture. [cite_start]Your task is to prove this connection. [cite: 283]\\n\\n1.  [cite_start]**Identify a Risk Event:** Pinpoint a specific date/time when your organization recognized a change in risk that should have prompted an adjustment in auditing. [cite: 283]\\n2.  [cite_start]**Filter for Components:** Use the dashboard's global filters (e.g., `host.name: <your_component_name>` or `data_stream.dataset: <your_dataset>`) to focus on the systems or services affected by the risk change. [cite: 284]\\n3.  **Analyze Trends:** Use the 'Audit Event Volume Trend' visualization to see if there was a noticeable increase in log volume for the affected components after the risk event. [cite_start]A sustained increase is evidence of enhanced logging. [cite: 285, 286]\\n4.  **Verify Policy Changes:** The 'Audit Policy & Configuration Changes' table is your most direct evidence. [cite_start]Look for events immediately following the risk event that show new audit rules being loaded (`auditctl`), policies being applied (`auditpol.exe`), or configuration files being modified. [cite: 286, 287]\\n5.  **Compare Event Types:** Use the 'Audit Event Type Breakdown' to compare the distribution of event types *before* and *after* the risk event. [cite_start]A change in the distribution (e.g., a shift from monitoring logins to monitoring file integrity) demonstrates a qualitative adjustment to auditing. [cite: 288, 289]\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"3582613c-8ab9-461a-a3ce-8ad54a542962\",\"gridData\":{\"i\":\"3582613c-8ab9-461a-a3ce-8ad54a542962\",\"y\":0,\"x\":0,\"w\":48,\"h\":6}},{\"type\":\"visualization\",\"title\":\"[CCI-000172] Audit Generation - Adjusting Audit Levels in Response to Risk ML\",\"panelRefName\":\"panel_7de33e5c-63b6-4c05-ad0b-daaee614e9d2\",\"embeddableConfig\":{\"description\":\"This visualization displays the health status for CCI-000172, adjusting audit levels in response to risk, based on the anomaly scores from the associated ML job. A high score indicates rare or unusual audit configuration changes that may require investigation.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"7de33e5c-63b6-4c05-ad0b-daaee614e9d2\",\"gridData\":{\"i\":\"7de33e5c-63b6-4c05-ad0b-daaee614e9d2\",\"y\":6,\"x\":0,\"w\":48,\"h\":9}},{\"type\":\"visualization\",\"title\":\"[CCI-000172] Audit Policy & Configuration Changes\",\"panelRefName\":\"panel_dfa30d33-883c-48a4-9600-4f4b87f77a9f\",\"embeddableConfig\":{\"description\":\"**Why and When:** This table provides the most direct evidence of compliance. [cite: 295] It captures the specific events where an administrator or automated process actively changed the audit configuration on a system. [cite_start]Look for these events immediately following a known change in risk. [cite: 295, 296]\\n\\n**How an Analyst Can Use It:**\\n1. [cite_start]Use the time filter to narrow your search to the period just after the risk event occurred. [cite: 297]\\n2. [cite_start]Filter by `host.name` to focus on the relevant systems. [cite: 298]\\n3. Examine the results for processes like `auditctl` (Linux rule loading), `auditpol.exe` (Windows policy change), or modifications to key configuration files (e.g., `filebeat.yml`).\\n4. [cite_start]The `user.name`, `process.command_line`, and `@timestamp` fields provide a clear record of who made what change and when. [cite: 299] [cite_start]This is your 'smoking gun' evidence. [cite: 300]\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"dfa30d33-883c-48a4-9600-4f4b87f77a9f\",\"gridData\":{\"i\":\"dfa30d33-883c-48a4-9600-4f4b87f77a9f\",\"y\":30,\"x\":0,\"w\":48,\"h\":13}},{\"type\":\"visualization\",\"title\":\"[CCI-000172] Audit Event Type Breakdown (Before vs. After)\",\"panelRefName\":\"panel_97b0efa0-555e-4bf8-aac8-142a668ffd2e\",\"embeddableConfig\":{\"description\":\"**Why and When:** This visualization demonstrates a qualitative shift in audit focus. [cite_start]If a new risk involves file integrity, you should see an increase in `file_modify` or `file_access` events. [cite: 290] [cite_start]This shows that the audit adjustment was not just about volume, but about collecting more relevant data. [cite: 291]\\n\\n**How an Analyst Can Use It:**\\n1. [cite_start]Select a time range *before* the risk event. [cite: 292] [cite_start]Note the percentage breakdown of the top event actions. [cite: 292]\\n2. [cite_start]Select a time range *after* the risk event. [cite: 293]\\n3. Compare the two breakdowns. [cite_start]A significant change in the distribution of event actions (e.g., `file_change` events becoming more prominent) provides strong evidence that the audit focus was adjusted to meet the new risk. [cite: 294]\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"97b0efa0-555e-4bf8-aac8-142a668ffd2e\",\"gridData\":{\"i\":\"97b0efa0-555e-4bf8-aac8-142a668ffd2e\",\"y\":15,\"x\":24,\"w\":24,\"h\":15}}]","timeRestore":false,"title":"[CCI-000172]","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-08-07T04:08:48.827Z","created_by":"u_elastic_found","id":"c5ff871e-9108-473d-ba6f-093de4678f9c","managed":false,"references":[{"id":"au-12-cci-000172-ml-detailed-anomalies","name":"26723801-4cbd-420e-adb4-27dcdd0161a8:panel_26723801-4cbd-420e-adb4-27dcdd0161a8","type":"visualization"},{"id":"cci-000172-title","name":"3582613c-8ab9-461a-a3ce-8ad54a542962:panel_3582613c-8ab9-461a-a3ce-8ad54a542962","type":"visualization"},{"id":"cci-000172-title-ml","name":"7de33e5c-63b6-4c05-ad0b-daaee614e9d2:panel_7de33e5c-63b6-4c05-ad0b-daaee614e9d2","type":"visualization"},{"id":"cci-000172-policy-changes-table","name":"dfa30d33-883c-48a4-9600-4f4b87f77a9f:panel_dfa30d33-883c-48a4-9600-4f4b87f77a9f","type":"visualization"},{"id":"cci-000172-event-breakdown-pie","name":"97b0efa0-555e-4bf8-aac8-142a668ffd2e:panel_97b0efa0-555e-4bf8-aac8-142a668ffd2e","type":"visualization"},{"id":"b8021d80-2ada-40e9-82cb-cb85d7225fa6","name":"tag-ref-b8021d80-2ada-40e9-82cb-cb85d7225fa6","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","name":"tag-ref-30441975-ef53-4eee-8a2c-df8b8a9e0331","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":".ml-anomalies-*","name":"26723801-4cbd-420e-adb4-27dcdd0161a8:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"a29e5b80-5153-41b7-803e-de885f06f383:indexpattern-datasource-layer-041f5ad7-dbac-4d24-af59-2118a19a9f10","type":"index-pattern"},{"id":"logs-*","name":"3582613c-8ab9-461a-a3ce-8ad54a542962:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"dfa30d33-883c-48a4-9600-4f4b87f77a9f:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"97b0efa0-555e-4bf8-aac8-142a668ffd2e:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-09-07T13:20:24.343Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzg2OTksN10="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":15,"missingRefCount":0,"missingReferences":[]}