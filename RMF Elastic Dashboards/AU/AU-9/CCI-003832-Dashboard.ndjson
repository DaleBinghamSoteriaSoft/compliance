{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"@timestamp\":{\"count\":1},\"agent.type\":{\"count\":8},\"event.action\":{\"count\":1},\"event.category\":{\"count\":8},\"event.dataset\":{\"count\":6},\"event.kind\":{\"count\":2},\"event.module\":{\"count\":6},\"event.outcome\":{\"count\":3},\"event.type\":{\"count\":1},\"file.path\":{\"count\":4},\"host.name\":{\"count\":1},\"message\":{\"count\":4},\"package.name\":{\"count\":1},\"package.version\":{\"count\":1},\"process.args\":{\"count\":1},\"process.command_line\":{\"count\":4},\"process.entity_id\":{\"count\":1},\"process.exit_code\":{\"count\":4},\"process.name\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":"logs-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":"logs-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T16:46:38.680Z","created_by":"u_elastic_found","id":"logs-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-08-07T04:07:01.675Z","updated_by":"u_elastic_found","version":"WzcxMjgsN10="}
{"attributes":{"color":"#f21b44","description":"","name":"mltitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:40:46.065Z","created_by":"u_elastic_found","id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:40:46.065Z","updated_by":"u_elastic_found","version":"WzQ2OTcsMl0="}
{"attributes":{"color":"#0e431f","description":"","name":"ml"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:32:52.214Z","created_by":"u_elastic_found","id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T18:32:52.214Z","updated_by":"u_elastic_found","version":"WzMyNzcsMV0="}
{"attributes":{"color":"#c7f175","description":"","name":"compliance"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI3LDdd"}
{"attributes":{"color":"#fa7d07","description":"","name":"au-9"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:45:42.636Z","created_by":"u_elastic_found","id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T14:45:42.636Z","updated_by":"u_elastic_found","version":"WzIxNjEsMV0="}
{"attributes":{"color":"#cde303","description":"","name":"rmf"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI2LDdd"}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T19:10:00.315Z","created_by":"u_elastic_found","id":".ml-anomalies-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-23T01:28:26.924Z","updated_by":"u_elastic_found","version":"WzE2MDMsMl0="}
{"attributes":{"description":"This section provides visualizations to help you assess compliance with CCI-003832, focusing on validating that designated personnel or roles are properly alerted upon detection of unauthorized access, modification, or deletion of audit information. The visualizations here highlight the *events* that should trigger such alerts. To perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters like 'host.name: <your_component_name>' to focus on a specific system. Observe the trends and individual events in the visualizations for any unauthorized activity. Your primary task as an analyst is to verify that for each detected unauthorized event, an alert was indeed generated and received by the specific 'Alert Group defined per role' for that component. This often involves cross-referencing with your organization's alert management system or incident response logs. The goal is to ensure that the *definition* of who gets alerted translates into *actual* alerts for relevant security incidents, ensuring timely response and compliance. This visualization now displays the health status for CCI-003832 based on the anomaly scores from associated ML jobs.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-9-cci-003831-003842-unauth-activity-trend\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-003832] Alert Personnel on Unauthorized Audit Activity ML","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-003832] Alert Personnel on Unauthorized Audit Activity ML\",\"type\":\"metrics\",\"aggs\":[],\"params\":{\"time_range_mode\":\"entire_time_range\",\"axis_formatter\":\"number\",\"axis_position\":\"left\",\"axis_scale\":\"normal\",\"background_color_rules\":[{\"value\":0,\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-red\",\"operator\":\"gte\"},{\"value\":20,\"background_color\":\"rgba(255,221,0,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-yellow\",\"operator\":\"gte\"},{\"value\":100,\"background_color\":\"rgba(249,3,3,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-green\",\"operator\":\"gte\"}],\"bar_color_rules\":[],\"drop_last_bucket\":0,\"filter\":{\"language\":\"kuery\",\"query\":\"job_id:au-9-cci-003831-003842-unauth-activity-trend\"},\"gauge_color_rules\":[],\"gauge_inner_width\":10,\"gauge_style\":\"half\",\"gauge_width\":10,\"id\":\"cci-003832-title\",\"interval\":\"\",\"isModelInvalid\":false,\"max_lines_legend\":1,\"series\":[{\"time_range_mode\":\"entire_time_range\",\"axis_position\":\"right\",\"chart_type\":\"line\",\"color\":\"#68BC00\",\"fill\":0.5,\"formatter\":\"0,0.[00]\",\"hidden\":false,\"id\":\"metric-1\",\"label\":\"CCI-003832 Health Status\",\"line_width\":1,\"metrics\":[{\"field\":\"anomaly_score\",\"id\":\"max-anomaly-score\",\"type\":\"max\"}],\"override_index_pattern\":0,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"point_size\":1,\"separate_axis\":0,\"series_drop_last_bucket\":0,\"split_mode\":\"everything\",\"stacked\":\"none\"}],\"show_grid\":1,\"show_legend\":1,\"time_field\":\"@timestamp\",\"tooltip_mode\":\"show_all\",\"truncate_legend\":1,\"type\":\"metric\",\"use_kibana_indexes\":true,\"index_pattern_ref_name\":\"metrics_0_index_pattern\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:38:27.855Z","created_by":"u_elastic_found","id":"cci-003832-title","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","name":"tag-ref-7dbb121c-e6c4-4063-88e0-37634f9b6a92","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":".ml-anomalies-*","name":"metrics_0_index_pattern","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-22T15:52:01.147Z","updated_by":"u_elastic_found","version":"WzEzMTAsMl0="}
{"attributes":{"color":"#d4cfb9","description":"","name":"metrics"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI1LDdd"}
{"attributes":{"description":"This table provides a detailed breakdown of individual events related to unauthorized access, modification, or deletion of audit information. These are the specific events that should trigger alerts to your defined personnel, directly supporting **CCI-003831** and **CCI-003832**. \n\n**Why this visualization works:** It offers granular detail on each event, including the timestamp, host, user, affected file, and the specific action attempted. This level of detail is crucial for in-depth investigation and allows you to pinpoint exact policy violations that demand an alert. It enables a direct cross-reference with your alert system to confirm that each specific incident resulted in the expected notification to the 'Alert Group defined per role'. \n\n**How an analyst can use it:** Sort by '@timestamp' to see the most recent events, or by 'user.name' to identify repeat offenders. Examine 'file.path' to pinpoint specific audit resources being targeted. The 'event.action' field will show what unauthorized action was attempted (e.g., access, change, delete). For each event displayed here (especially those indicating a critical unauthorized action), you must **verify that a corresponding alert was generated and successfully delivered** to the appropriate personnel or roles as defined by your organization's policy for **CCI-003831** and **CCI-003832**. This table is essential for detailed compliance verification at the individual event level. Remember to apply global filters for specific components (e.g., 'host.name: <your_component_name>') to refine your view.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(*authorized_user* OR *system* OR *administrator* OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9, CCI-003831, CCI-003832] Detailed Unauthorized Audit Activity Events (for Alert Verification)","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9, CCI-003831, CCI-003832] Detailed Unauthorized Audit Activity Events (for Alert Verification)\",\"type\":\"table\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"customLabel\":\"Event Count\",\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"host.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"user.name\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"5\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"file.path\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"6\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"}],\"params\":{\"autoFitRowToContent\":false,\"perPage\":10,\"percentageCol\":\"\",\"showMetricsAtAllLevels\":true,\"showPartialRows\":false,\"showToolbar\":false,\"showTotal\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"totalFunc\":\"sum\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-cci-3831-3832-detailed-activity-events","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-23T14:53:27.589Z","updated_by":"u_elastic_found","version":"WzE5MzEsMl0="}
{"attributes":{"description":"This visualization displays the total count of unauthorized access, modification, or deletion attempts on audit information. This metric is crucial for both **CCI-003831** (alerting personnel) and **CCI-003832** (verifying alerts). \n\n**Why this visualization works:** It provides a quick, high-level understanding of the overall unauthorized activity that *should* be triggering alerts to the defined personnel. A non-zero count here immediately indicates a need for the analyst to investigate whether an alert was appropriately generated and delivered to the correct 'Alert Group defined per role'. \n\n**How an analyst can use it:** Use this metric in conjunction with the trend visualization to understand if a high number of unauthorized attempts is a recent spike or a persistent issue. This visualization acts as a quick health check for the effectiveness of your alerting mechanisms. A continuously high count, even if not spiking, suggests a need for deeper investigation into why unauthorized users are attempting to interact with audit data, and more importantly, to verify if your defined alerting procedures are being followed and are effective in notifying the appropriate personnel for these events. Remember to use global filters to focus on specific components (e.g., 'host.name: <your_component_name>').","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(*authorized_user* OR *system* OR *administrator* OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9, CCI-003831, CCI-003832] Total Unauthorized Audit Activity (for Alert Verification)","uiStateJSON":"{}","version":1,"visState":"{\"aggs\":[{\"enabled\":true,\"id\":\"1\",\"params\":{\"customLabel\":\"Total Unauthorized Activity\",\"emptyAsNull\":false},\"schema\":\"metric\",\"type\":\"count\"}],\"params\":{\"addLegend\":false,\"addTooltip\":true,\"fontSize\":\"60\",\"metric\":{\"colorSchema\":\"Green to Red\",\"colorsRange\":[{\"from\":0,\"to\":10000}],\"invertColors\":false,\"labels\":{\"show\":true},\"metricColorMode\":\"None\",\"percentageMode\":false,\"style\":{\"bgColor\":false,\"bgFill\":\"#000\",\"fontSize\":60,\"labelColor\":false,\"subText\":\"\"},\"useRanges\":false},\"type\":\"metric\"},\"title\":\"[AU-9, CCI-003831, CCI-003832] Total Unauthorized Audit Activity (for Alert Verification)\",\"type\":\"metric\"}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-cci-3831-3832-total-activity","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-21T14:49:10.164Z","updated_by":"u_elastic_found","version":"WzUxOSwxXQ=="}
{"attributes":{"description":"This visualization presents a breakdown of access, modification, and deletion attempts by their outcome (success or failure) and the type of action performed. This provides a critical summary for the overall **AU-9** control, and is relevant to **CCI-000162, CCI-000163, CCI-000164, CCI-001494, CCI-001495, CCI-003831, and CCI-003832**. \n\n**Why this visualization works:** It offers a quick visual summary of the effectiveness of audit information protection mechanisms. A high number of successful unauthorized attempts is a clear indication of a compliance failure, while a high number of failed attempts might indicate active threats or misconfigurations that need to be addressed, directly supporting the requirements of AU-9 to protect audit information. \n\n**How an analyst can use it:** Prioritize investigation into successful unauthorized attempts. Analyze the distribution of failed vs. successful attempts to understand if protection mechanisms are effectively thwarting unauthorized actions. Use global filters to drill down into specific components or timeframes. This visualization provides an immediate compliance status check for AU-9, helping you quickly identify areas where audit information or tools are vulnerable to unauthorized access, modification, or deletion. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)\",\"type\":\"pie\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"split\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.outcome\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"segment\"}],\"params\":{\"addLegend\":true,\"addTooltip\":true,\"distinctColors\":false,\"donut\":false,\"emptySizeRatio\":0.3,\"is={true}\":true,\"isDonut\":true,\"labels\":{\"last_level\":false,\"percentDecimals\":2,\"position\":\"default\",\"show\":true,\"truncate\":100,\"values\":true,\"valuesFormat\":\"percent\"},\"legendDisplay\":\"hide\",\"legendPosition\":\"right\",\"maxLegendLines\":1,\"nestedLegend\":false,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"radius\":\"90%\",\"row\":true,\"truncateLegend\":true,\"type\":\"pie\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-outcome-action-breakdown","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-23T02:01:51.878Z","updated_by":"u_elastic_found","version":"WzE2NzksMl0="}
{"attributes":{"color":"#f8bfc4","description":"","name":"dashboard"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-25T21:49:36.527Z","created_by":"u_elastic_found","id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-25T21:49:36.527Z","updated_by":"u_elastic_found","version":"WzI2MzUxLDNd"}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"visualization\",\"title\":\"[CCI-003832] Alert Personnel on Unauthorized Audit Activity ML\",\"panelRefName\":\"panel_4c9513df-f63c-4581-ada5-97afe46eab3d\",\"embeddableConfig\":{\"description\":\"This section provides visualizations to help you assess compliance with CCI-003832, focusing on validating that designated personnel or roles are properly alerted upon detection of unauthorized access, modification, or deletion of audit information. The visualizations here highlight the *events* that should trigger such alerts. To perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters like 'host.name: <your_component_name>' to focus on a specific system. Observe the trends and individual events in the visualizations for any unauthorized activity. Your primary task as an analyst is to verify that for each detected unauthorized event, an alert was indeed generated and received by the specific 'Alert Group defined per role' for that component. This often involves cross-referencing with your organization's alert management system or incident response logs. The goal is to ensure that the *definition* of who gets alerted translates into *actual* alerts for relevant security incidents, ensuring timely response and compliance. This visualization now displays the health status for CCI-003832 based on the anomaly scores from associated ML jobs.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"4c9513df-f63c-4581-ada5-97afe46eab3d\",\"gridData\":{\"i\":\"4c9513df-f63c-4581-ada5-97afe46eab3d\",\"y\":0,\"x\":0,\"w\":48,\"h\":9}},{\"type\":\"visualization\",\"title\":\"[AU-9, CCI-003831, CCI-003832] Detailed Unauthorized Audit Activity Events (for Alert Verification)\",\"panelRefName\":\"panel_ee193d7f-8109-41eb-877b-832c5cfc5375\",\"embeddableConfig\":{\"description\":\"This table provides a detailed breakdown of individual events related to unauthorized access, modification, or deletion of audit information. These are the specific events that should trigger alerts to your defined personnel, directly supporting **CCI-003831** and **CCI-003832**. \\n\\n**Why this visualization works:** It offers granular detail on each event, including the timestamp, host, user, affected file, and the specific action attempted. This level of detail is crucial for in-depth investigation and allows you to pinpoint exact policy violations that demand an alert. It enables a direct cross-reference with your alert system to confirm that each specific incident resulted in the expected notification to the 'Alert Group defined per role'. \\n\\n**How an analyst can use it:** Sort by '@timestamp' to see the most recent events, or by 'user.name' to identify repeat offenders. Examine 'file.path' to pinpoint specific audit resources being targeted. The 'event.action' field will show what unauthorized action was attempted (e.g., access, change, delete). For each event displayed here (especially those indicating a critical unauthorized action), you must **verify that a corresponding alert was generated and successfully delivered** to the appropriate personnel or roles as defined by your organization's policy for **CCI-003831** and **CCI-003832**. This table is essential for detailed compliance verification at the individual event level. Remember to apply global filters for specific components (e.g., 'host.name: <your_component_name>') to refine your view.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"ee193d7f-8109-41eb-877b-832c5cfc5375\",\"gridData\":{\"i\":\"ee193d7f-8109-41eb-877b-832c5cfc5375\",\"y\":39,\"x\":0,\"w\":48,\"h\":19}},{\"type\":\"visualization\",\"title\":\"[AU-9, CCI-003831, CCI-003832] Total Unauthorized Audit Activity (for Alert Verification)\",\"panelRefName\":\"panel_903385a1-fb98-48cb-accb-10a1d6bea6f5\",\"embeddableConfig\":{\"description\":\"This visualization displays the total count of unauthorized access, modification, or deletion attempts on audit information. This metric is crucial for both **CCI-003831** (alerting personnel) and **CCI-003832** (verifying alerts). \\n\\n**Why this visualization works:** It provides a quick, high-level understanding of the overall unauthorized activity that *should* be triggering alerts to the defined personnel. A non-zero count here immediately indicates a need for the analyst to investigate whether an alert was appropriately generated and delivered to the correct 'Alert Group defined per role'. \\n\\n**How an analyst can use it:** Use this metric in conjunction with the trend visualization to understand if a high number of unauthorized attempts is a recent spike or a persistent issue. This visualization acts as a quick health check for the effectiveness of your alerting mechanisms. A continuously high count, even if not spiking, suggests a need for deeper investigation into why unauthorized users are attempting to interact with audit data, and more importantly, to verify if your defined alerting procedures are being followed and are effective in notifying the appropriate personnel for these events. Remember to use global filters to focus on specific components (e.g., 'host.name: <your_component_name>').\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"903385a1-fb98-48cb-accb-10a1d6bea6f5\",\"gridData\":{\"i\":\"903385a1-fb98-48cb-accb-10a1d6bea6f5\",\"y\":9,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"[AU-9, CCI-003831, CCI-003832] Unauthorized Audit Activity Trend (for Alert Verification) (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(*authorized_user* OR *system* OR *administrator* OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.outcome:success)\"},\"attributes\":{\"title\":\"[AU-9, CCI-003831, CCI-003832] Unauthorized Audit Activity Trend (for Alert Verification) (converted)\",\"description\":\"This visualization displays a time-series trend of unauthorized attempts to access, modify, or delete audit information. This is critical for monitoring compliance with both **CCI-003831** (alerting personnel on unauthorized audit activity) and **CCI-003832** (verifying that designated personnel are alerted). \\n\\n**Why this visualization works:** It provides a quick visual of spikes or consistent unauthorized activities over time, which are the types of events that *should* be triggering alerts to the defined personnel. By observing this trend, you can understand the frequency and patterns of incidents that require attention from the designated alert group. This visualization indirectly supports compliance by showing the raw events that need to be acted upon. \\n\\n**How an analyst can use it:** Look for sudden increases in unauthorized events or a consistently high baseline. Hover over data points to see the exact count at a given time. Use the time range selector to narrow down suspicious periods. After identifying periods with unauthorized activity, your next step is to **verify with your organization's alert management system** that appropriate alerts were sent to and actioned by the 'Alert Group defined per role' for the specific component you are reviewing. This helps ensure that your defined alerting mechanisms are effectively responding to security incidents and that **CCI-003832** requirements are met. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\"logs-*\",\"name\":\"indexpattern-datasource-layer-14f8a2dd-3b62-4698-803e-10ccc2bc99ea\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"14f8a2dd-3b62-4698-803e-10ccc2bc99ea\",\"accessors\":[\"0b2099ba-4b2d-4656-9dd7-79f29608f508\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"e59aa087-713e-4fff-a3e6-ee74aa9892f0\",\"simpleView\":false,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"yConfig\":[{\"forAccessor\":\"0b2099ba-4b2d-4656-9dd7-79f29608f508\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(*authorized_user* OR *system* OR *administrator* OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.outcome:success)\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"14f8a2dd-3b62-4698-803e-10ccc2bc99ea\":{\"ignoreGlobalFilters\":false,\"columns\":{\"e59aa087-713e-4fff-a3e6-ee74aa9892f0\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"0b2099ba-4b2d-4656-9dd7-79f29608f508\":{\"label\":\"Count\",\"dataType\":\"number\",\"operationType\":\"count\",\"isBucketed\":false,\"sourceField\":\"___records___\",\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"e59aa087-713e-4fff-a3e6-ee74aa9892f0\",\"0b2099ba-4b2d-4656-9dd7-79f29608f508\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"79616eb3-0363-407b-9f02-28f397f67ff2\",\"gridData\":{\"i\":\"79616eb3-0363-407b-9f02-28f397f67ff2\",\"y\":24,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)\",\"panelRefName\":\"panel_fe5934af-fc5e-4607-94c9-88ba13cb3e83\",\"embeddableConfig\":{\"description\":\"This visualization presents a breakdown of access, modification, and deletion attempts by their outcome (success or failure) and the type of action performed. This provides a critical summary for the overall **AU-9** control, and is relevant to **CCI-000162, CCI-000163, CCI-000164, CCI-001494, CCI-001495, CCI-003831, and CCI-003832**. \\n\\n**Why this visualization works:** It offers a quick visual summary of the effectiveness of audit information protection mechanisms. A high number of successful unauthorized attempts is a clear indication of a compliance failure, while a high number of failed attempts might indicate active threats or misconfigurations that need to be addressed, directly supporting the requirements of AU-9 to protect audit information. \\n\\n**How an analyst can use it:** Prioritize investigation into successful unauthorized attempts. Analyze the distribution of failed vs. successful attempts to understand if protection mechanisms are effectively thwarting unauthorized actions. Use global filters to drill down into specific components or timeframes. This visualization provides an immediate compliance status check for AU-9, helping you quickly identify areas where audit information or tools are vulnerable to unauthorized access, modification, or deletion. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"fe5934af-fc5e-4607-94c9-88ba13cb3e83\",\"gridData\":{\"i\":\"fe5934af-fc5e-4607-94c9-88ba13cb3e83\",\"y\":9,\"x\":0,\"w\":24,\"h\":30}}]","timeRestore":false,"title":"[CCI-003832 AU-9]","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-09-07T13:24:10.350Z","created_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","id":"ec069af6-6943-4860-bb12-62fc7bbadeb9","managed":false,"references":[{"id":"cci-003832-title","name":"4c9513df-f63c-4581-ada5-97afe46eab3d:panel_4c9513df-f63c-4581-ada5-97afe46eab3d","type":"visualization"},{"id":"au-9-cci-3831-3832-detailed-activity-events","name":"ee193d7f-8109-41eb-877b-832c5cfc5375:panel_ee193d7f-8109-41eb-877b-832c5cfc5375","type":"visualization"},{"id":"au-9-cci-3831-3832-total-activity","name":"903385a1-fb98-48cb-accb-10a1d6bea6f5:panel_903385a1-fb98-48cb-accb-10a1d6bea6f5","type":"visualization"},{"id":"au-9-outcome-action-breakdown","name":"fe5934af-fc5e-4607-94c9-88ba13cb3e83:panel_fe5934af-fc5e-4607-94c9-88ba13cb3e83","type":"visualization"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","name":"tag-ref-30441975-ef53-4eee-8a2c-df8b8a9e0331","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"logs-*","name":"4c9513df-f63c-4581-ada5-97afe46eab3d:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"4c9513df-f63c-4581-ada5-97afe46eab3d:metrics_0_index_pattern","type":"index-pattern"},{"id":"logs-*","name":"ee193d7f-8109-41eb-877b-832c5cfc5375:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"903385a1-fb98-48cb-accb-10a1d6bea6f5:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"79616eb3-0363-407b-9f02-28f397f67ff2:indexpattern-datasource-layer-14f8a2dd-3b62-4698-803e-10ccc2bc99ea","type":"index-pattern"},{"id":"logs-*","name":"fe5934af-fc5e-4607-94c9-88ba13cb3e83:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-09-07T13:24:13.298Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzg3MzUsN10="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":14,"missingRefCount":0,"missingReferences":[]}