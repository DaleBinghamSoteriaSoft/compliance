{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"@timestamp\":{\"count\":1},\"agent.type\":{\"count\":8},\"event.action\":{\"count\":1},\"event.category\":{\"count\":8},\"event.dataset\":{\"count\":6},\"event.kind\":{\"count\":2},\"event.module\":{\"count\":6},\"event.outcome\":{\"count\":3},\"event.type\":{\"count\":1},\"file.path\":{\"count\":4},\"host.name\":{\"count\":1},\"message\":{\"count\":4},\"package.name\":{\"count\":1},\"package.version\":{\"count\":1},\"process.args\":{\"count\":1},\"process.command_line\":{\"count\":4},\"process.entity_id\":{\"count\":1},\"process.exit_code\":{\"count\":4},\"process.name\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":"logs-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":"logs-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T16:46:38.680Z","created_by":"u_elastic_found","id":"logs-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-08-07T04:07:01.675Z","updated_by":"u_elastic_found","version":"WzcxMjgsN10="}
{"attributes":{"color":"#d4cfb9","description":"","name":"metrics"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI1LDdd"}
{"attributes":{"color":"#c7f175","description":"","name":"compliance"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI3LDdd"}
{"attributes":{"color":"#fa7d07","description":"","name":"au-9"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:45:42.636Z","created_by":"u_elastic_found","id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T14:45:42.636Z","updated_by":"u_elastic_found","version":"WzIxNjEsMV0="}
{"attributes":{"color":"#cde303","description":"","name":"rmf"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-26T14:19:47.462Z","created_by":"u_elastic_found","id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-26T14:19:47.462Z","updated_by":"u_elastic_found","version":"WzMxMDI2LDdd"}
{"attributes":{"description":"This visualization displays the total count of instances where unauthorized deletion attempts were made on audit tools, providing a high-level overview for **CCI-001495** (protecting audit tools from unauthorized deletion). \n\n**Why this visualization works:** It provides a quick, high-level understanding of the overall unauthorized activity directed at protecting audit tools. A non-zero count here immediately flags a potential compliance issue, signaling a need for deeper investigation into your deletion controls. \n\n**How an analyst can use it:** Use this metric in conjunction with the trend visualization to understand if a high number of unauthorized attempts is a recent spike or a persistent issue. This visualization acts as a quick health check for the deletion controls on audit tools. A continuously high count, even if not spiking, suggests a need for deeper investigation into why unauthorized users are attempting to delete audit functions. Remember to use global filters to focus on specific components (e.g., 'host.name: <your_component_name>').","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe)) AND (event.category:(file OR process OR registry) OR event.type:(deletion OR file_delete OR process_termination OR registry_key_deletion)) AND NOT (user.name:(*system* OR *administrator* OR 'authorized_admin_group' OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.action:file_delete AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9, CCI-001495] Total Unauthorized Audit Tool Deletions","uiStateJSON":"{}","version":1,"visState":"{\"aggs\":[{\"enabled\":true,\"id\":\"1\",\"params\":{\"customLabel\":\"Total Unauthorized Deletions\",\"emptyAsNull\":false},\"schema\":\"metric\",\"type\":\"count\"}],\"params\":{\"addLegend\":false,\"addTooltip\":true,\"fontSize\":\"60\",\"metric\":{\"colorSchema\":\"Green to Red\",\"colorsRange\":[{\"from\":0,\"to\":10000}],\"invertColors\":false,\"labels\":{\"show\":true},\"metricColorMode\":\"None\",\"percentageMode\":false,\"style\":{\"bgColor\":false,\"bgFill\":\"#000\",\"fontSize\":60,\"labelColor\":false,\"subText\":\"\"},\"useRanges\":false},\"type\":\"metric\"},\"title\":\"[AU-9, CCI-001495] Total Unauthorized Audit Tool Deletions\",\"type\":\"metric\"}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"cci-001495-total-deletions","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-21T14:55:25.135Z","updated_by":"u_elastic_found","version":"WzU0MSwxXQ=="}
{"attributes":{"description":"This visualization presents a breakdown of access, modification, and deletion attempts by their outcome (success or failure) and the type of action performed. This provides a critical summary for the overall **AU-9** control, and is relevant to **CCI-000162, CCI-000163, CCI-000164, CCI-001494, CCI-001495, CCI-003831, and CCI-003832**. \n\n**Why this visualization works:** It offers a quick visual summary of the effectiveness of audit information protection mechanisms. A high number of successful unauthorized attempts is a clear indication of a compliance failure, while a high number of failed attempts might indicate active threats or misconfigurations that need to be addressed, directly supporting the requirements of AU-9 to protect audit information. \n\n**How an analyst can use it:** Prioritize investigation into successful unauthorized attempts. Analyze the distribution of failed vs. successful attempts to understand if protection mechanisms are effectively thwarting unauthorized actions. Use global filters to drill down into specific components or timeframes. This visualization provides an immediate compliance status check for AU-9, helping you quickly identify areas where audit information or tools are vulnerable to unauthorized access, modification, or deletion. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)\",\"type\":\"pie\",\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"params\":{\"emptyAsNull\":false},\"schema\":\"metric\"},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":10,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"split\"},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"event.outcome\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"segment\"}],\"params\":{\"addLegend\":true,\"addTooltip\":true,\"distinctColors\":false,\"donut\":false,\"emptySizeRatio\":0.3,\"is={true}\":true,\"isDonut\":true,\"labels\":{\"last_level\":false,\"percentDecimals\":2,\"position\":\"default\",\"show\":true,\"truncate\":100,\"values\":true,\"valuesFormat\":\"percent\"},\"legendDisplay\":\"hide\",\"legendPosition\":\"right\",\"maxLegendLines\":1,\"nestedLegend\":false,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"radius\":\"90%\",\"row\":true,\"truncateLegend\":true,\"type\":\"pie\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"au-9-outcome-action-breakdown","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-23T02:01:51.878Z","updated_by":"u_elastic_found","version":"WzE2NzksMl0="}
{"attributes":{"description":"This visualization displays the top audit files or processes that are subject to access, modification, or deletion attempts. This is a vital overview for the entire **AU-9** control, encompassing aspects of **CCI-000162, CCI-000163, CCI-000164, CCI-001494, and CCI-001495**. \n\n**Why this visualization works:** It helps analysts quickly identify the most frequently targeted audit resources (logs or tools). A sudden spike or consistent activity on a specific audit file or process, especially by unauthorized users, can indicate a focused attack or a critical misconfiguration. This allows for targeted investigation on the most critical audit components, ensuring comprehensive protection. \n\n**How an analyst can use it:** Monitor for any audit files or processes with unusually high activity. Drill down into specific 'file.path' or 'process.name' entries to see the detailed events. If unauthorized attempts are concentrated on a few critical audit resources, this visualization helps pinpoint the immediate areas requiring attention for AU-9 compliance across all related CCIs. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').","state":{"adHocDataViews":{},"datasourceStates":{"formBased":{"layers":{"d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11":{"columnOrder":["b9da6ea0-2a0f-4656-953f-c97f1b381ef2","e7eabdfb-59f1-4a23-a57d-7fd6012339ef","0731af5e-a459-4821-bb6d-7ed96645c88e"],"columns":{"0731af5e-a459-4821-bb6d-7ed96645c88e":{"dataType":"number","isBucketed":false,"label":"Count of records","operationType":"count","params":{"emptyAsNull":true},"scale":"ratio","sourceField":"___records___"},"b9da6ea0-2a0f-4656-953f-c97f1b381ef2":{"dataType":"string","isBucketed":true,"label":"Top 8 values of file.path","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"0731af5e-a459-4821-bb6d-7ed96645c88e","type":"column"},"orderDirection":"desc","otherBucket":false,"parentFormat":{"id":"terms"},"size":8},"scale":"ordinal","sourceField":"file.path"},"e7eabdfb-59f1-4a23-a57d-7fd6012339ef":{"dataType":"string","isBucketed":true,"label":"Top 6 values of process.name","operationType":"terms","params":{"exclude":[],"excludeIsRegex":false,"include":[],"includeIsRegex":false,"missingBucket":false,"orderBy":{"columnId":"0731af5e-a459-4821-bb6d-7ed96645c88e","type":"column"},"orderDirection":"desc","otherBucket":true,"parentFormat":{"id":"terms"},"size":6},"scale":"ordinal","sourceField":"process.name"}},"incompleteColumns":{},"sampling":1}}},"indexpattern":{"layers":{}},"textBased":{"layers":{}}},"filters":[],"internalReferences":[],"query":{"language":"kuery","query":"(file.path:\"/var/log/audit/*\" OR file.path:\"C:\\Windows\\System32\\winevt\\Logs\\*\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \"NT AUTHORITY\\SYSTEM\" OR LocalSystem OR NetworkService) AND event.outcome:success) "},"visualization":{"axisTitlesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"fittingFunction":"Linear","gridlinesVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"labelsOrientation":{"x":0,"yLeft":0,"yRight":0},"layers":[{"accessors":["0731af5e-a459-4821-bb6d-7ed96645c88e"],"colorMapping":{"assignments":[],"colorMode":{"type":"categorical"},"paletteId":"default","specialAssignments":[{"color":{"type":"loop"},"rule":{"type":"other"},"touched":false}]},"layerId":"d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","layerType":"data","seriesType":"bar_stacked","splitAccessor":"b9da6ea0-2a0f-4656-953f-c97f1b381ef2","xAccessor":"e7eabdfb-59f1-4a23-a57d-7fd6012339ef"}],"legend":{"isVisible":true,"position":"right"},"preferredSeriesType":"bar_stacked","tickLabelsVisibilitySettings":{"x":true,"yLeft":true,"yRight":true},"valueLabels":"hide"}},"title":"[AU-9] Top Targeted Audit Resources (All AU-9 CCIs)","visualizationType":"lnsXY"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T14:07:26.755Z","created_by":"u_elastic_found","id":"595d3392-1102-4220-afa0-df19d4164e50","managed":false,"references":[{"id":"logs-*","name":"indexpattern-datasource-layer-d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"lens","typeMigrationVersion":"8.9.0","updated_at":"2025-07-23T14:07:26.755Z","updated_by":"u_elastic_found","version":"WzE3NzYsMl0="}
{"attributes":{"allowHidden":false,"allowNoIndex":true,"fieldAttrs":"{\"anomaly_score\":{\"count\":1},\"user.name\":{\"count\":1}}","fieldFormatMap":"{}","fields":"[]","name":".ml-anomalies-*","runtimeFieldMap":"{}","sourceFilters":"[]","timeFieldName":"@timestamp","title":".ml-anomalies-*"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T19:10:00.315Z","created_by":"u_elastic_found","id":".ml-anomalies-*","managed":true,"references":[],"type":"index-pattern","typeMigrationVersion":"8.0.0","updated_at":"2025-07-23T01:28:26.924Z","updated_by":"u_elastic_found","version":"WzE2MDMsMl0="}
{"attributes":{"description":"This table provides a detailed breakdown of the most significant anomalies related to the modification or deletion of audit information and tools.\n\n**Why this visualization works:**\nIt provides the critical details needed for a forensic investigation. By highlighting the influencers (user, file, process, action), it allows an analyst to quickly understand the context of an anomalous change and determine if it was a legitimate administrative action or a malicious act.\n\n**How an analyst can use it:**\nFilter for high anomaly scores (e.g., anomaly_score >= 75). Focus on the `influencers.file.path` to see what was changed and `influencers.event.action` to see how (modification or deletion). Cross-reference with `influencers.user.name` to verify authorization. This is your primary tool for investigating potential tampering events.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"query\":\"job_id : \\\"au-9-cci-001494-001495-audit-mod-del-trend\\\" and anomaly_score >= 1\",\"language\":\"kuery\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9-CCIs-001494,1495] ML - Detailed Audit Mod/Del Anomalies","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[AU-9-CCIs-001494,1495] ML - Detailed Audit Mod/Del Anomalies\",\"type\":\"table\",\"aggs\":[{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"params\":{\"field\":\"@timestamp\",\"orderBy\":\"_key\",\"order\":\"desc\",\"size\":10,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"includeIsRegex\":true,\"excludeIsRegex\":true},\"schema\":\"bucket\"},{\"id\":\"4\",\"enabled\":true,\"type\":\"max\",\"params\":{\"field\":\"anomaly_score\"},\"schema\":\"metric\"}],\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":true,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showToolbar\":true,\"percentageCol\":\"\",\"autoFitRowToContent\":false}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:30:33.016Z","created_by":"u_elastic_found","id":"au-9-cci-001494-001495-ml-detailed-anomalies","managed":false,"references":[{"id":".ml-anomalies-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-23T14:35:51.757Z","updated_by":"u_elastic_found","version":"WzE4NjksMl0="}
{"attributes":{"color":"#f21b44","description":"","name":"mltitle"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:40:46.065Z","created_by":"u_elastic_found","id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-22T00:40:46.065Z","updated_by":"u_elastic_found","version":"WzQ2OTcsMl0="}
{"attributes":{"color":"#0e431f","description":"","name":"ml"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T18:32:52.214Z","created_by":"u_elastic_found","id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-21T18:32:52.214Z","updated_by":"u_elastic_found","version":"WzMyNzcsMV0="}
{"attributes":{"description":"This section provides visualizations to help you assess compliance with CCI-001495, focusing on protecting audit tools from unauthorized deletion. You'll find visualizations designed to highlight any attempts to remove audit tool configurations, binaries, or logs. To perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters like 'host.name: <your_component_name>' to focus on a specific system. Observe the trends and individual events in the visualizations for any anomalies or unauthorized deletions. Any deletion event not performed by an explicitly authorized user or process should be investigated thoroughly. This visualization now displays the health status for CCI-001495 based on the anomaly scores from associated ML jobs.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"job_id:au-9-cci-001494-001495-audit-mod-del-trend\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[CCI-001495] Protect Audit Tools from Unauthorized Deletion ML","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"[CCI-001495] Protect Audit Tools from Unauthorized Deletion ML\",\"type\":\"metrics\",\"aggs\":[],\"params\":{\"time_range_mode\":\"entire_time_range\",\"axis_formatter\":\"number\",\"axis_position\":\"left\",\"axis_scale\":\"normal\",\"background_color_rules\":[{\"value\":0,\"background_color\":\"rgba(14,242,71,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-red\",\"operator\":\"gte\"},{\"value\":20,\"background_color\":\"rgba(255,221,0,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-yellow\",\"operator\":\"gte\"},{\"value\":100,\"background_color\":\"rgba(249,3,3,1)\",\"color\":\"rgba(0,0,0,1)\",\"id\":\"anomaly-green\",\"operator\":\"gte\"}],\"bar_color_rules\":[],\"drop_last_bucket\":0,\"filter\":{\"language\":\"kuery\",\"query\":\"job_id:au-9-cci-001494-001495-audit-mod-del-trend\"},\"gauge_color_rules\":[],\"gauge_inner_width\":10,\"gauge_style\":\"half\",\"gauge_width\":10,\"id\":\"cci-001495-title\",\"interval\":\"\",\"isModelInvalid\":false,\"max_lines_legend\":1,\"series\":[{\"time_range_mode\":\"entire_time_range\",\"axis_position\":\"right\",\"chart_type\":\"line\",\"color\":\"#68BC00\",\"fill\":0.5,\"formatter\":\"0,0.[00]\",\"hidden\":false,\"id\":\"metric-1\",\"label\":\"CCI-001495 Health Status\",\"line_width\":1,\"metrics\":[{\"field\":\"anomaly_score\",\"id\":\"max-anomaly-score\",\"type\":\"max\"}],\"override_index_pattern\":0,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"point_size\":1,\"separate_axis\":0,\"series_drop_last_bucket\":0,\"split_mode\":\"everything\",\"stacked\":\"none\"}],\"show_grid\":1,\"show_legend\":1,\"time_field\":\"@timestamp\",\"tooltip_mode\":\"show_all\",\"truncate_legend\":1,\"type\":\"metric\",\"use_kibana_indexes\":true,\"index_pattern_ref_name\":\"metrics_0_index_pattern\"}}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-22T00:38:27.855Z","created_by":"u_elastic_found","id":"cci-001495-title","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"7dbb121c-e6c4-4063-88e0-37634f9b6a92","name":"tag-ref-7dbb121c-e6c4-4063-88e0-37634f9b6a92","type":"tag"},{"id":"16a78fb6-67bc-49bd-9ab6-98469903abf9","name":"tag-ref-16a78fb6-67bc-49bd-9ab6-98469903abf9","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":".ml-anomalies-*","name":"metrics_0_index_pattern","type":"index-pattern"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-22T15:51:39.515Z","updated_by":"u_elastic_found","version":"WzEzMDAsMl0="}
{"attributes":{"description":"This table provides a detailed breakdown of individual events related to unauthorized deletions of audit tools, offering granular insights for **CCI-001495** (protecting audit tools from unauthorized deletion). \n\n**Why this visualization works:** It offers granular detail on each event, including the timestamp, host, user, process, and file involved, and the specific action attempted. This level of detail is crucial for in-depth investigation and pinpointing exact policy violations, allowing you to understand the 'who, what, and where' of potential audit tool availability failures. \n\n**How an analyst can use it:** Sort by 'user.name' or 'process.name' to identify common sources of unauthorized activity. Examine 'file.path' to pinpoint specific audit resources being targeted. The 'event.action' field will confirm the deletion attempt. This table is critical for understanding the context of each unauthorized deletion and verifying if your deletion controls are working as intended. Remember to apply global filters for specific components (e.g., 'host.name: <your_component_name>') to refine your view.","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe)) AND (event.category:(file OR process OR registry) OR event.type:(deletion OR file_delete OR process_termination OR registry_key_deletion)) AND NOT (user.name:(*system* OR *administrator* OR 'authorized_admin_group' OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.action:file_delete AND event.outcome:success)\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"},"title":"[AU-9, CCI-001495] Detailed Unauthorized Audit Tool Deletion Events","uiStateJSON":"{}","version":1,"visState":"{\"aggs\":[{\"enabled\":true,\"id\":\"1\",\"params\":{\"customLabel\":\"Event Count\",\"emptyAsNull\":false},\"schema\":\"metric\",\"type\":\"count\"},{\"enabled\":true,\"id\":\"2\",\"params\":{\"excludeIsRegex\":true,\"field\":\"@timestamp\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"3\",\"params\":{\"excludeIsRegex\":true,\"field\":\"host.name\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"4\",\"params\":{\"excludeIsRegex\":true,\"field\":\"user.name\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"5\",\"params\":{\"excludeIsRegex\":true,\"field\":\"process.name\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"6\",\"params\":{\"excludeIsRegex\":true,\"field\":\"file.path\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"},{\"enabled\":true,\"id\":\"7\",\"params\":{\"excludeIsRegex\":true,\"field\":\"event.action\",\"includeIsRegex\":true,\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"size\":10},\"schema\":\"bucket\",\"type\":\"terms\"}],\"params\":{\"autoFitRowToContent\":false,\"perPage\":10,\"percentageCol\":\"\",\"showMetricsAtAllLevels\":true,\"showPartialRows\":false,\"showToolbar\":false,\"showTotal\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"totalFunc\":\"sum\"},\"title\":\"[AU-9, CCI-001495] Detailed Unauthorized Audit Tool Deletion Events\",\"type\":\"table\"}"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-21T14:38:03.146Z","created_by":"u_elastic_found","id":"cci-001495-detailed-del-events","managed":false,"references":[{"id":"logs-*","name":"kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","name":"tag-ref-f8a9bc91-dfea-4b69-a149-7c8ee0b2e440","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"}],"type":"visualization","typeMigrationVersion":"8.5.0","updated_at":"2025-07-21T14:55:17.218Z","updated_by":"u_elastic_found","version":"WzU0MCwxXQ=="}
{"attributes":{"color":"#f8bfc4","description":"","name":"dashboard"},"coreMigrationVersion":"8.8.0","created_at":"2025-07-25T21:49:36.527Z","created_by":"u_elastic_found","id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-07-25T21:49:36.527Z","updated_by":"u_elastic_found","version":"WzI2MzUxLDNd"}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"lens\",\"title\":\"[AU-9, CCI-001495] Unauthorized Audit Tool Deletion Trend (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"description\":\"This visualization displays a time-series trend of attempts to delete audit tools, directly supporting compliance with **CCI-001495** (protecting audit tools from unauthorized deletion). \\n\\n**Why this visualization works:** It provides a quick visual of spikes or consistent attempts to delete audit tools over time, which can indicate an ongoing attack or a persistent misconfiguration. Identifying these trends allows for proactive intervention and helps you assess the effectiveness of your deletion controls on audit tools. \\n\\n**How an analyst can use it:** Look for sudden increases in deletion events or a consistently high baseline. Hover over data points to see the exact count at a given time. Use the time range selector to narrow down suspicious periods. This helps you understand if audit tool protection mechanisms are being consistently challenged. Pay close attention to events where 'user.name' is not an authorized administrator, and remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"1269433c-db8e-415f-af8b-807782a5b196\",\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe)) AND (event.category:(file OR process OR registry) OR event.type:(deletion OR file_delete OR process_termination OR registry_key_deletion)) AND NOT (user.name:(*system* OR *administrator* OR 'authorized_admin_group' OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.action:file_delete AND event.outcome:success)\"},\"attributes\":{\"title\":\"[AU-9, CCI-001495] Unauthorized Audit Tool Deletion Trend (converted)\",\"description\":\"This visualization displays a time-series trend of attempts to delete audit tools, directly supporting compliance with **CCI-001495** (protecting audit tools from unauthorized deletion). \\n\\n**Why this visualization works:** It provides a quick visual of spikes or consistent attempts to delete audit tools over time, which can indicate an ongoing attack or a persistent misconfiguration. Identifying these trends allows for proactive intervention and helps you assess the effectiveness of your deletion controls on audit tools. \\n\\n**How an analyst can use it:** Look for sudden increases in deletion events or a consistently high baseline. Hover over data points to see the exact count at a given time. Use the time range selector to narrow down suspicious periods. This helps you understand if audit tool protection mechanisms are being consistently challenged. Pay close attention to events where 'user.name' is not an authorized administrator, and remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\"logs-*\",\"name\":\"indexpattern-datasource-layer-162c2f48-c64d-4a91-8284-d0101586fff7\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"162c2f48-c64d-4a91-8284-d0101586fff7\",\"accessors\":[\"adb2e586-81b4-420b-a40f-4f04f3ba4b66\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"f49e0ffe-2620-4221-8b4b-a8b25046366c\",\"simpleView\":false,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"yConfig\":[{\"forAccessor\":\"adb2e586-81b4-420b-a40f-4f04f3ba4b66\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe)) AND (event.category:(file OR process OR registry) OR event.type:(deletion OR file_delete OR process_termination OR registry_key_deletion)) AND NOT (user.name:(*system* OR *administrator* OR 'authorized_admin_group' OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) AND NOT (process.name:auditd AND event.action:file_delete AND event.outcome:success)\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"162c2f48-c64d-4a91-8284-d0101586fff7\":{\"ignoreGlobalFilters\":false,\"columns\":{\"f49e0ffe-2620-4221-8b4b-a8b25046366c\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"scale\":\"interval\",\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"adb2e586-81b4-420b-a40f-4f04f3ba4b66\":{\"label\":\"Count\",\"dataType\":\"number\",\"operationType\":\"count\",\"isBucketed\":false,\"scale\":\"ratio\",\"sourceField\":\"___records___\",\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"f49e0ffe-2620-4221-8b4b-a8b25046366c\",\"adb2e586-81b4-420b-a40f-4f04f3ba4b66\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"a272a540-00b5-4a26-a5a3-314563eb2752\",\"gridData\":{\"i\":\"a272a540-00b5-4a26-a5a3-314563eb2752\",\"y\":24,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[AU-9, CCI-001495] Total Unauthorized Audit Tool Deletions\",\"panelRefName\":\"panel_833c9cc5-5c3c-4d72-87c8-545fb8d31069\",\"embeddableConfig\":{\"description\":\"This visualization displays the total count of instances where unauthorized deletion attempts were made on audit tools, providing a high-level overview for **CCI-001495** (protecting audit tools from unauthorized deletion). \\n\\n**Why this visualization works:** It provides a quick, high-level understanding of the overall unauthorized activity directed at protecting audit tools. A non-zero count here immediately flags a potential compliance issue, signaling a need for deeper investigation into your deletion controls. \\n\\n**How an analyst can use it:** Use this metric in conjunction with the trend visualization to understand if a high number of unauthorized attempts is a recent spike or a persistent issue. This visualization acts as a quick health check for the deletion controls on audit tools. A continuously high count, even if not spiking, suggests a need for deeper investigation into why unauthorized users are attempting to delete audit functions. Remember to use global filters to focus on specific components (e.g., 'host.name: <your_component_name>').\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"833c9cc5-5c3c-4d72-87c8-545fb8d31069\",\"gridData\":{\"i\":\"833c9cc5-5c3c-4d72-87c8-545fb8d31069\",\"y\":39,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"[AU-9-CCIs-001494,1495] ML - Audit Mod/Del Anomaly Score Trend (converted)\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"description\":\"This visualization displays the maximum anomaly score over time for the job monitoring modification and deletion of audit data and tools.\\n\\n**Why this visualization works:**\\nIt provides a clear timeline of when potentially malicious modifications or deletions are taking place. Such actions are high-risk indicators of an attempt to cover tracks or disable security monitoring. The ML model provides an additional layer of defense by detecting unusual patterns of these activities.\\n\\n**How an analyst can use it:**\\nAny spike in this chart is a high-priority event. Use the time selector to focus on the period of the anomaly and use the detailed table to immediately identify the user, file, and process involved to assess the nature of the threat.\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"1269433c-db8e-415f-af8b-807782a5b196\",\"filters\":[],\"query\":{\"language\":\"kuery\",\"query\":\"job_id : \\\"au-9-cci-001494-001495-audit-mod-del-trend\\\"\"},\"attributes\":{\"title\":\"[AU-9-CCIs-001494,1495] ML - Audit Mod/Del Anomaly Score Trend (converted)\",\"description\":\"This visualization displays the maximum anomaly score over time for the job monitoring modification and deletion of audit data and tools.\\n\\n**Why this visualization works:**\\nIt provides a clear timeline of when potentially malicious modifications or deletions are taking place. Such actions are high-risk indicators of an attempt to cover tracks or disable security monitoring. The ML model provides an additional layer of defense by detecting unusual patterns of these activities.\\n\\n**How an analyst can use it:**\\nAny spike in this chart is a high-priority event. Use the time selector to focus on the period of the anomaly and use the detailed table to immediately identify the user, file, and process involved to assess the nature of the threat.\",\"visualizationType\":\"lnsXY\",\"type\":\"lens\",\"references\":[{\"type\":\"index-pattern\",\"id\":\".ml-anomalies-*\",\"name\":\"indexpattern-datasource-layer-786fd949-00f4-4099-8663-7b9a41c22e5e\"}],\"state\":{\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\",\"legendSize\":\"auto\",\"shouldTruncate\":true,\"maxLines\":1,\"showSingleSeries\":true},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"curveType\":\"LINEAR\",\"yTitle\":\"\",\"showCurrentTimeMarker\":false,\"yLeftExtent\":{\"mode\":\"full\",\"enforce\":true},\"yLeftScale\":\"linear\",\"yRightScale\":\"linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":-90},\"gridlinesVisibilitySettings\":{\"x\":false,\"yLeft\":false,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"786fd949-00f4-4099-8663-7b9a41c22e5e\",\"accessors\":[\"d139ee61-6f53-4b7d-b751-a9133c73c15a\"],\"layerType\":\"data\",\"seriesType\":\"area_stacked\",\"xAccessor\":\"45919aab-4d6b-4772-8c15-783931e0b3fe\",\"simpleView\":false,\"palette\":{\"name\":\"default\",\"type\":\"palette\"},\"yConfig\":[{\"forAccessor\":\"d139ee61-6f53-4b7d-b751-a9133c73c15a\",\"axisMode\":\"left\"}],\"xScaleType\":\"time\",\"isHistogram\":true}]},\"query\":{\"language\":\"kuery\",\"query\":\"job_id : \\\"au-9-cci-001494-001495-audit-mod-del-trend\\\"\"},\"filters\":[],\"datasourceStates\":{\"formBased\":{\"layers\":{\"786fd949-00f4-4099-8663-7b9a41c22e5e\":{\"ignoreGlobalFilters\":false,\"columns\":{\"45919aab-4d6b-4772-8c15-783931e0b3fe\":{\"label\":\"@timestamp\",\"dataType\":\"date\",\"operationType\":\"date_histogram\",\"sourceField\":\"@timestamp\",\"isBucketed\":true,\"scale\":\"interval\",\"params\":{\"interval\":\"auto\",\"includeEmptyRows\":false,\"dropPartials\":false},\"customLabel\":true},\"d139ee61-6f53-4b7d-b751-a9133c73c15a\":{\"label\":\"Max anomaly_score\",\"dataType\":\"number\",\"operationType\":\"max\",\"sourceField\":\"anomaly_score\",\"isBucketed\":false,\"scale\":\"ratio\",\"params\":{\"emptyAsNull\":true},\"customLabel\":true}},\"columnOrder\":[\"45919aab-4d6b-4772-8c15-783931e0b3fe\",\"d139ee61-6f53-4b7d-b751-a9133c73c15a\"],\"incompleteColumns\":{}}}},\"indexpattern\":{\"layers\":{}},\"textBased\":{\"layers\":{}}},\"internalReferences\":[],\"adHocDataViews\":{}}}},\"panelIndex\":\"2c0ed036-5706-4720-a259-385f0900b679\",\"gridData\":{\"i\":\"2c0ed036-5706-4720-a259-385f0900b679\",\"y\":24,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"visualization\",\"title\":\"[AU-9] Audit Activity Outcome and Action Breakdown (All CCIs)\",\"panelRefName\":\"panel_ef99b65f-e199-4f59-9aea-5d0ad544a7dd\",\"embeddableConfig\":{\"description\":\"This visualization presents a breakdown of access, modification, and deletion attempts by their outcome (success or failure) and the type of action performed. This provides a critical summary for the overall **AU-9** control, and is relevant to **CCI-000162, CCI-000163, CCI-000164, CCI-001494, CCI-001495, CCI-003831, and CCI-003832**. \\n\\n**Why this visualization works:** It offers a quick visual summary of the effectiveness of audit information protection mechanisms. A high number of successful unauthorized attempts is a clear indication of a compliance failure, while a high number of failed attempts might indicate active threats or misconfigurations that need to be addressed, directly supporting the requirements of AU-9 to protect audit information. \\n\\n**How an analyst can use it:** Prioritize investigation into successful unauthorized attempts. Analyze the distribution of failed vs. successful attempts to understand if protection mechanisms are effectively thwarting unauthorized actions. Use global filters to drill down into specific components or timeframes. This visualization provides an immediate compliance status check for AU-9, helping you quickly identify areas where audit information or tools are vulnerable to unauthorized access, modification, or deletion. Remember to use global filters to focus on a specific component (e.g., 'host.name: <your_component_name>').\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"ef99b65f-e199-4f59-9aea-5d0ad544a7dd\",\"gridData\":{\"i\":\"ef99b65f-e199-4f59-9aea-5d0ad544a7dd\",\"y\":39,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"panelRefName\":\"panel_595f4eaf-544c-4a20-9658-785225b877d8\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"1269433c-db8e-415f-af8b-807782a5b196\",\"filters\":[],\"query\":{\"query\":\"(file.path:\\\"/var/log/audit/*\\\" OR file.path:\\\"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\*\\\" OR file.extension:(log OR evtx OR json OR xml OR conf OR cfg OR ini) OR process.name:(auditd OR wevtutil OR auditpol OR journalctl OR powershell.exe OR cmd.exe OR bash OR wmic OR sc.exe OR reg.exe OR net.exe OR taskkill.exe OR schtasks.exe OR at.exe OR psexec.exe OR mimikatz.exe OR certutil.exe OR bitsadmin.exe) OR event.module:(auditbeat OR winlogbeat OR filebeat OR sysmon OR osquery OR zeek OR suricata) OR cloud.service.name:(CloudTrail OR Azure Activity Logs OR GCP Audit Logs OR Kubernetes)) AND (event.category:(file OR process OR registry OR network OR iam) OR event.type:(access OR modification OR deletion OR creation OR configuration OR execution OR authentication OR authorization OR policy OR service_control)) AND NOT (user.name:(system OR administrator OR \\\"NT AUTHORITY\\\\SYSTEM\\\" OR LocalSystem OR NetworkService) AND event.outcome:success) \",\"language\":\"kuery\"}},\"panelIndex\":\"595f4eaf-544c-4a20-9658-785225b877d8\",\"gridData\":{\"i\":\"595f4eaf-544c-4a20-9658-785225b877d8\",\"y\":54,\"x\":0,\"w\":48,\"h\":18}},{\"type\":\"visualization\",\"title\":\"[AU-9-CCIs-001494,1495] ML - Detailed Audit Mod/Del Anomalies\",\"panelRefName\":\"panel_cba3c31d-2354-4f02-985a-22efb511c78e\",\"embeddableConfig\":{\"description\":\"This table provides a detailed breakdown of the most significant anomalies related to the modification or deletion of audit information and tools.\\n\\n**Why this visualization works:**\\nIt provides the critical details needed for a forensic investigation. By highlighting the influencers (user, file, process, action), it allows an analyst to quickly understand the context of an anomalous change and determine if it was a legitimate administrative action or a malicious act.\\n\\n**How an analyst can use it:**\\nFilter for high anomaly scores (e.g., anomaly_score >= 75). Focus on the `influencers.file.path` to see what was changed and `influencers.event.action` to see how (modification or deletion). Cross-reference with `influencers.user.name` to verify authorization. This is your primary tool for investigating potential tampering events.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"cba3c31d-2354-4f02-985a-22efb511c78e\",\"gridData\":{\"i\":\"cba3c31d-2354-4f02-985a-22efb511c78e\",\"y\":0,\"x\":35,\"w\":13,\"h\":10}},{\"type\":\"visualization\",\"title\":\"[CCI-001495] Protect Audit Tools from Unauthorized Deletion ML\",\"panelRefName\":\"panel_d8ae3c3a-b295-43ab-aa22-2896737dc6a7\",\"embeddableConfig\":{\"description\":\"This section provides visualizations to help you assess compliance with CCI-001495, focusing on protecting audit tools from unauthorized deletion. You'll find visualizations designed to highlight any attempts to remove audit tool configurations, binaries, or logs. To perform a component-level compliance assessment, utilize the global filters at the top of the Kibana dashboard. Apply filters like 'host.name: <your_component_name>' to focus on a specific system. Observe the trends and individual events in the visualizations for any anomalies or unauthorized deletions. Any deletion event not performed by an explicitly authorized user or process should be investigated thoroughly. This visualization now displays the health status for CCI-001495 based on the anomaly scores from associated ML jobs.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"d8ae3c3a-b295-43ab-aa22-2896737dc6a7\",\"gridData\":{\"i\":\"d8ae3c3a-b295-43ab-aa22-2896737dc6a7\",\"y\":0,\"x\":0,\"w\":35,\"h\":10}},{\"type\":\"visualization\",\"title\":\"[AU-9, CCI-001495] Detailed Unauthorized Audit Tool Deletion Events\",\"panelRefName\":\"panel_eb071fdf-3607-4ea2-8d10-026fa5ae9c05\",\"embeddableConfig\":{\"description\":\"This table provides a detailed breakdown of individual events related to unauthorized deletions of audit tools, offering granular insights for **CCI-001495** (protecting audit tools from unauthorized deletion). \\n\\n**Why this visualization works:** It offers granular detail on each event, including the timestamp, host, user, process, and file involved, and the specific action attempted. This level of detail is crucial for in-depth investigation and pinpointing exact policy violations, allowing you to understand the 'who, what, and where' of potential audit tool availability failures. \\n\\n**How an analyst can use it:** Sort by 'user.name' or 'process.name' to identify common sources of unauthorized activity. Examine 'file.path' to pinpoint specific audit resources being targeted. The 'event.action' field will confirm the deletion attempt. This table is critical for understanding the context of each unauthorized deletion and verifying if your deletion controls are working as intended. Remember to apply global filters for specific components (e.g., 'host.name: <your_component_name>') to refine your view.\",\"enhancements\":{\"dynamicActions\":{\"events\":[]}}},\"panelIndex\":\"eb071fdf-3607-4ea2-8d10-026fa5ae9c05\",\"gridData\":{\"i\":\"eb071fdf-3607-4ea2-8d10-026fa5ae9c05\",\"y\":10,\"x\":0,\"w\":48,\"h\":14}}]","timeRestore":false,"title":"[CCI-001495] CCI RMF Dashboard","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-07-23T14:26:36.086Z","created_by":"u_elastic_found","id":"4b7b591b-4837-450e-97f9-af41f0faba0d","managed":false,"references":[{"id":"cci-001495-total-deletions","name":"833c9cc5-5c3c-4d72-87c8-545fb8d31069:panel_833c9cc5-5c3c-4d72-87c8-545fb8d31069","type":"visualization"},{"id":"au-9-outcome-action-breakdown","name":"ef99b65f-e199-4f59-9aea-5d0ad544a7dd:panel_ef99b65f-e199-4f59-9aea-5d0ad544a7dd","type":"visualization"},{"id":"595d3392-1102-4220-afa0-df19d4164e50","name":"595f4eaf-544c-4a20-9658-785225b877d8:panel_595f4eaf-544c-4a20-9658-785225b877d8","type":"lens"},{"id":"au-9-cci-001494-001495-ml-detailed-anomalies","name":"cba3c31d-2354-4f02-985a-22efb511c78e:panel_cba3c31d-2354-4f02-985a-22efb511c78e","type":"visualization"},{"id":"cci-001495-title","name":"d8ae3c3a-b295-43ab-aa22-2896737dc6a7:panel_d8ae3c3a-b295-43ab-aa22-2896737dc6a7","type":"visualization"},{"id":"cci-001495-detailed-del-events","name":"eb071fdf-3607-4ea2-8d10-026fa5ae9c05:panel_eb071fdf-3607-4ea2-8d10-026fa5ae9c05","type":"visualization"},{"id":"6691b7c2-a0cf-4995-8854-60a36257bb3c","name":"tag-ref-6691b7c2-a0cf-4995-8854-60a36257bb3c","type":"tag"},{"id":"dd97659c-f547-45e0-ab7c-bf6e897ed682","name":"tag-ref-dd97659c-f547-45e0-ab7c-bf6e897ed682","type":"tag"},{"id":"4a93e19f-a649-4c6a-a61e-5261143ecb92","name":"tag-ref-4a93e19f-a649-4c6a-a61e-5261143ecb92","type":"tag"},{"id":"30441975-ef53-4eee-8a2c-df8b8a9e0331","name":"tag-ref-30441975-ef53-4eee-8a2c-df8b8a9e0331","type":"tag"},{"id":"logs-*","name":"a272a540-00b5-4a26-a5a3-314563eb2752:indexpattern-datasource-layer-162c2f48-c64d-4a91-8284-d0101586fff7","type":"index-pattern"},{"id":"logs-*","name":"833c9cc5-5c3c-4d72-87c8-545fb8d31069:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"2c0ed036-5706-4720-a259-385f0900b679:indexpattern-datasource-layer-786fd949-00f4-4099-8663-7b9a41c22e5e","type":"index-pattern"},{"id":"logs-*","name":"ef99b65f-e199-4f59-9aea-5d0ad544a7dd:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"595f4eaf-544c-4a20-9658-785225b877d8:indexpattern-datasource-layer-d2e2ecdf-bc3d-44d2-bf05-83f9292f5e11","type":"index-pattern"},{"id":".ml-anomalies-*","name":"cba3c31d-2354-4f02-985a-22efb511c78e:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":"logs-*","name":"d8ae3c3a-b295-43ab-aa22-2896737dc6a7:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"},{"id":".ml-anomalies-*","name":"d8ae3c3a-b295-43ab-aa22-2896737dc6a7:metrics_0_index_pattern","type":"index-pattern"},{"id":"logs-*","name":"eb071fdf-3607-4ea2-8d10-026fa5ae9c05:kibanaSavedObjectMeta.searchSourceJSON.index","type":"index-pattern"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-09-10T01:46:14.322Z","updated_by":"u_0mU_98uy2P8SmsJ-9Xgc5oslWMQadK8fLdymNcvu8H0_0","version":"Wzk4NTYsN10="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":16,"missingRefCount":0,"missingReferences":[]}